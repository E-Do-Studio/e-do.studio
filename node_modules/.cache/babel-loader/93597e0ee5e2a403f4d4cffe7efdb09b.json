{"ast":null,"code":"import { Object3D, Vector2, Vector3, Matrix4 } from \"three\";\n\nclass CSS2DObject extends Object3D {\n  constructor(element = document.createElement(\"div\")) {\n    super();\n    this.isCSS2DObject = true;\n    this.element = element;\n    this.element.style.position = \"absolute\";\n    this.element.style.userSelect = \"none\";\n    this.element.setAttribute(\"draggable\", false);\n    this.center = new Vector2(0.5, 0.5);\n    this.addEventListener(\"removed\", function () {\n      this.traverse(function (object) {\n        if (object.element instanceof Element && object.element.parentNode !== null) {\n          object.element.parentNode.removeChild(object.element);\n        }\n      });\n    });\n  }\n\n  copy(source, recursive) {\n    super.copy(source, recursive);\n    this.element = source.element.cloneNode(true);\n    this.center = source.center;\n    return this;\n  }\n\n}\n\nconst _vector = /* @__PURE__ */new Vector3();\n\nconst _viewMatrix = /* @__PURE__ */new Matrix4();\n\nconst _viewProjectionMatrix = /* @__PURE__ */new Matrix4();\n\nconst _a = /* @__PURE__ */new Vector3();\n\nconst _b = /* @__PURE__ */new Vector3();\n\nclass CSS2DRenderer {\n  constructor(parameters = {}) {\n    const _this = this;\n\n    let _width, _height;\n\n    let _widthHalf, _heightHalf;\n\n    const cache = {\n      objects: /* @__PURE__ */new WeakMap()\n    };\n    const domElement = parameters.element !== void 0 ? parameters.element : document.createElement(\"div\");\n    domElement.style.overflow = \"hidden\";\n    this.domElement = domElement;\n\n    this.getSize = function () {\n      return {\n        width: _width,\n        height: _height\n      };\n    };\n\n    this.render = function (scene, camera) {\n      if (scene.matrixWorldAutoUpdate === true) scene.updateMatrixWorld();\n      if (camera.parent === null && camera.matrixWorldAutoUpdate === true) camera.updateMatrixWorld();\n\n      _viewMatrix.copy(camera.matrixWorldInverse);\n\n      _viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, _viewMatrix);\n\n      renderObject(scene, scene, camera);\n      zOrder(scene);\n    };\n\n    this.setSize = function (width, height) {\n      _width = width;\n      _height = height;\n      _widthHalf = _width / 2;\n      _heightHalf = _height / 2;\n      domElement.style.width = width + \"px\";\n      domElement.style.height = height + \"px\";\n    };\n\n    function renderObject(object, scene, camera) {\n      if (object.isCSS2DObject) {\n        _vector.setFromMatrixPosition(object.matrixWorld);\n\n        _vector.applyMatrix4(_viewProjectionMatrix);\n\n        const visible = object.visible === true && _vector.z >= -1 && _vector.z <= 1 && object.layers.test(camera.layers) === true;\n        object.element.style.display = visible === true ? \"\" : \"none\";\n\n        if (visible === true) {\n          object.onBeforeRender(_this, scene, camera);\n          const element = object.element;\n          element.style.transform = \"translate(\" + -100 * object.center.x + \"%,\" + -100 * object.center.y + \"%)translate(\" + (_vector.x * _widthHalf + _widthHalf) + \"px,\" + (-_vector.y * _heightHalf + _heightHalf) + \"px)\";\n\n          if (element.parentNode !== domElement) {\n            domElement.appendChild(element);\n          }\n\n          object.onAfterRender(_this, scene, camera);\n        }\n\n        const objectData = {\n          distanceToCameraSquared: getDistanceToSquared(camera, object)\n        };\n        cache.objects.set(object, objectData);\n      }\n\n      for (let i = 0, l = object.children.length; i < l; i++) {\n        renderObject(object.children[i], scene, camera);\n      }\n    }\n\n    function getDistanceToSquared(object1, object2) {\n      _a.setFromMatrixPosition(object1.matrixWorld);\n\n      _b.setFromMatrixPosition(object2.matrixWorld);\n\n      return _a.distanceToSquared(_b);\n    }\n\n    function filterAndFlatten(scene) {\n      const result = [];\n      scene.traverse(function (object) {\n        if (object.isCSS2DObject) result.push(object);\n      });\n      return result;\n    }\n\n    function zOrder(scene) {\n      const sorted = filterAndFlatten(scene).sort(function (a, b) {\n        if (a.renderOrder !== b.renderOrder) {\n          return b.renderOrder - a.renderOrder;\n        }\n\n        const distanceA = cache.objects.get(a).distanceToCameraSquared;\n        const distanceB = cache.objects.get(b).distanceToCameraSquared;\n        return distanceA - distanceB;\n      });\n      const zMax = sorted.length;\n\n      for (let i = 0, l = sorted.length; i < l; i++) {\n        sorted[i].element.style.zIndex = zMax - i;\n      }\n    }\n  }\n\n}\n\nexport { CSS2DObject, CSS2DRenderer };","map":{"version":3,"sources":["/Users/theodaguier/_workdir/dev/pro/e-do/E-Do-Studio/node_modules/three-stdlib/renderers/CSS2DRenderer.js"],"names":["Object3D","Vector2","Vector3","Matrix4","CSS2DObject","constructor","element","document","createElement","isCSS2DObject","style","position","userSelect","setAttribute","center","addEventListener","traverse","object","Element","parentNode","removeChild","copy","source","recursive","cloneNode","_vector","_viewMatrix","_viewProjectionMatrix","_a","_b","CSS2DRenderer","parameters","_this","_width","_height","_widthHalf","_heightHalf","cache","objects","WeakMap","domElement","overflow","getSize","width","height","render","scene","camera","matrixWorldAutoUpdate","updateMatrixWorld","parent","matrixWorldInverse","multiplyMatrices","projectionMatrix","renderObject","zOrder","setSize","setFromMatrixPosition","matrixWorld","applyMatrix4","visible","z","layers","test","display","onBeforeRender","transform","x","y","appendChild","onAfterRender","objectData","distanceToCameraSquared","getDistanceToSquared","set","i","l","children","length","object1","object2","distanceToSquared","filterAndFlatten","result","push","sorted","sort","a","b","renderOrder","distanceA","get","distanceB","zMax","zIndex"],"mappings":"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","sourcesContent":["import { Object3D, Vector2, Vector3, Matrix4 } from \"three\";\nclass CSS2DObject extends Object3D {\n  constructor(element = document.createElement(\"div\")) {\n    super();\n    this.isCSS2DObject = true;\n    this.element = element;\n    this.element.style.position = \"absolute\";\n    this.element.style.userSelect = \"none\";\n    this.element.setAttribute(\"draggable\", false);\n    this.center = new Vector2(0.5, 0.5);\n    this.addEventListener(\"removed\", function() {\n      this.traverse(function(object) {\n        if (object.element instanceof Element && object.element.parentNode !== null) {\n          object.element.parentNode.removeChild(object.element);\n        }\n      });\n    });\n  }\n  copy(source, recursive) {\n    super.copy(source, recursive);\n    this.element = source.element.cloneNode(true);\n    this.center = source.center;\n    return this;\n  }\n}\nconst _vector = /* @__PURE__ */ new Vector3();\nconst _viewMatrix = /* @__PURE__ */ new Matrix4();\nconst _viewProjectionMatrix = /* @__PURE__ */ new Matrix4();\nconst _a = /* @__PURE__ */ new Vector3();\nconst _b = /* @__PURE__ */ new Vector3();\nclass CSS2DRenderer {\n  constructor(parameters = {}) {\n    const _this = this;\n    let _width, _height;\n    let _widthHalf, _heightHalf;\n    const cache = {\n      objects: /* @__PURE__ */ new WeakMap()\n    };\n    const domElement = parameters.element !== void 0 ? parameters.element : document.createElement(\"div\");\n    domElement.style.overflow = \"hidden\";\n    this.domElement = domElement;\n    this.getSize = function() {\n      return {\n        width: _width,\n        height: _height\n      };\n    };\n    this.render = function(scene, camera) {\n      if (scene.matrixWorldAutoUpdate === true)\n        scene.updateMatrixWorld();\n      if (camera.parent === null && camera.matrixWorldAutoUpdate === true)\n        camera.updateMatrixWorld();\n      _viewMatrix.copy(camera.matrixWorldInverse);\n      _viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, _viewMatrix);\n      renderObject(scene, scene, camera);\n      zOrder(scene);\n    };\n    this.setSize = function(width, height) {\n      _width = width;\n      _height = height;\n      _widthHalf = _width / 2;\n      _heightHalf = _height / 2;\n      domElement.style.width = width + \"px\";\n      domElement.style.height = height + \"px\";\n    };\n    function renderObject(object, scene, camera) {\n      if (object.isCSS2DObject) {\n        _vector.setFromMatrixPosition(object.matrixWorld);\n        _vector.applyMatrix4(_viewProjectionMatrix);\n        const visible = object.visible === true && _vector.z >= -1 && _vector.z <= 1 && object.layers.test(camera.layers) === true;\n        object.element.style.display = visible === true ? \"\" : \"none\";\n        if (visible === true) {\n          object.onBeforeRender(_this, scene, camera);\n          const element = object.element;\n          element.style.transform = \"translate(\" + -100 * object.center.x + \"%,\" + -100 * object.center.y + \"%)translate(\" + (_vector.x * _widthHalf + _widthHalf) + \"px,\" + (-_vector.y * _heightHalf + _heightHalf) + \"px)\";\n          if (element.parentNode !== domElement) {\n            domElement.appendChild(element);\n          }\n          object.onAfterRender(_this, scene, camera);\n        }\n        const objectData = {\n          distanceToCameraSquared: getDistanceToSquared(camera, object)\n        };\n        cache.objects.set(object, objectData);\n      }\n      for (let i = 0, l = object.children.length; i < l; i++) {\n        renderObject(object.children[i], scene, camera);\n      }\n    }\n    function getDistanceToSquared(object1, object2) {\n      _a.setFromMatrixPosition(object1.matrixWorld);\n      _b.setFromMatrixPosition(object2.matrixWorld);\n      return _a.distanceToSquared(_b);\n    }\n    function filterAndFlatten(scene) {\n      const result = [];\n      scene.traverse(function(object) {\n        if (object.isCSS2DObject)\n          result.push(object);\n      });\n      return result;\n    }\n    function zOrder(scene) {\n      const sorted = filterAndFlatten(scene).sort(function(a, b) {\n        if (a.renderOrder !== b.renderOrder) {\n          return b.renderOrder - a.renderOrder;\n        }\n        const distanceA = cache.objects.get(a).distanceToCameraSquared;\n        const distanceB = cache.objects.get(b).distanceToCameraSquared;\n        return distanceA - distanceB;\n      });\n      const zMax = sorted.length;\n      for (let i = 0, l = sorted.length; i < l; i++) {\n        sorted[i].element.style.zIndex = zMax - i;\n      }\n    }\n  }\n}\nexport {\n  CSS2DObject,\n  CSS2DRenderer\n};\n"]},"metadata":{},"sourceType":"module"}