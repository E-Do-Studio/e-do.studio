{"ast":null,"code":"import _classCallCheck from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nvar __defProp = Object.defineProperty;\n\nvar __defNormalProp = function __defNormalProp(obj, key, value) {\n  return key in obj ? __defProp(obj, key, {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: value\n  }) : obj[key] = value;\n};\n\nvar __publicField = function __publicField(obj, key, value) {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n\n  return value;\n};\n\nimport { LinearFilter, RGBAFormat, Vector2, WebGLRenderTarget, Clock } from \"three\";\nimport { CopyShader } from \"../shaders/CopyShader.js\";\nimport { ShaderPass } from \"./ShaderPass.js\";\nimport { MaskPass, ClearMaskPass } from \"./MaskPass.js\";\n\nvar EffectComposer = /*#__PURE__*/function () {\n  function EffectComposer(renderer, renderTarget) {\n    _classCallCheck(this, EffectComposer);\n\n    __publicField(this, \"renderer\");\n\n    __publicField(this, \"_pixelRatio\");\n\n    __publicField(this, \"_width\");\n\n    __publicField(this, \"_height\");\n\n    __publicField(this, \"renderTarget1\");\n\n    __publicField(this, \"renderTarget2\");\n\n    __publicField(this, \"writeBuffer\");\n\n    __publicField(this, \"readBuffer\");\n\n    __publicField(this, \"renderToScreen\");\n\n    __publicField(this, \"passes\", []);\n\n    __publicField(this, \"copyPass\");\n\n    __publicField(this, \"clock\");\n\n    this.renderer = renderer;\n\n    if (renderTarget === void 0) {\n      var parameters = {\n        minFilter: LinearFilter,\n        magFilter: LinearFilter,\n        format: RGBAFormat\n      };\n      var size = renderer.getSize(new Vector2());\n      this._pixelRatio = renderer.getPixelRatio();\n      this._width = size.width;\n      this._height = size.height;\n      renderTarget = new WebGLRenderTarget(this._width * this._pixelRatio, this._height * this._pixelRatio, parameters);\n      renderTarget.texture.name = \"EffectComposer.rt1\";\n    } else {\n      this._pixelRatio = 1;\n      this._width = renderTarget.width;\n      this._height = renderTarget.height;\n    }\n\n    this.renderTarget1 = renderTarget;\n    this.renderTarget2 = renderTarget.clone();\n    this.renderTarget2.texture.name = \"EffectComposer.rt2\";\n    this.writeBuffer = this.renderTarget1;\n    this.readBuffer = this.renderTarget2;\n    this.renderToScreen = true;\n\n    if (CopyShader === void 0) {\n      console.error(\"THREE.EffectComposer relies on CopyShader\");\n    }\n\n    if (ShaderPass === void 0) {\n      console.error(\"THREE.EffectComposer relies on ShaderPass\");\n    }\n\n    this.copyPass = new ShaderPass(CopyShader);\n    this.clock = new Clock();\n  }\n\n  _createClass(EffectComposer, [{\n    key: \"swapBuffers\",\n    value: function swapBuffers() {\n      var tmp = this.readBuffer;\n      this.readBuffer = this.writeBuffer;\n      this.writeBuffer = tmp;\n    }\n  }, {\n    key: \"addPass\",\n    value: function addPass(pass) {\n      this.passes.push(pass);\n      pass.setSize(this._width * this._pixelRatio, this._height * this._pixelRatio);\n    }\n  }, {\n    key: \"insertPass\",\n    value: function insertPass(pass, index) {\n      this.passes.splice(index, 0, pass);\n      pass.setSize(this._width * this._pixelRatio, this._height * this._pixelRatio);\n    }\n  }, {\n    key: \"removePass\",\n    value: function removePass(pass) {\n      var index = this.passes.indexOf(pass);\n\n      if (index !== -1) {\n        this.passes.splice(index, 1);\n      }\n    }\n  }, {\n    key: \"isLastEnabledPass\",\n    value: function isLastEnabledPass(passIndex) {\n      for (var i = passIndex + 1; i < this.passes.length; i++) {\n        if (this.passes[i].enabled) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n  }, {\n    key: \"render\",\n    value: function render(deltaTime) {\n      if (deltaTime === void 0) {\n        deltaTime = this.clock.getDelta();\n      }\n\n      var currentRenderTarget = this.renderer.getRenderTarget();\n      var maskActive = false;\n      var il = this.passes.length;\n\n      for (var i = 0; i < il; i++) {\n        var pass = this.passes[i];\n        if (pass.enabled === false) continue;\n        pass.renderToScreen = this.renderToScreen && this.isLastEnabledPass(i);\n        pass.render(this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive);\n\n        if (pass.needsSwap) {\n          if (maskActive) {\n            var context = this.renderer.getContext();\n            var stencil = this.renderer.state.buffers.stencil;\n            stencil.setFunc(context.NOTEQUAL, 1, 4294967295);\n            this.copyPass.render(this.renderer, this.writeBuffer, this.readBuffer, deltaTime);\n            stencil.setFunc(context.EQUAL, 1, 4294967295);\n          }\n\n          this.swapBuffers();\n        }\n\n        if (MaskPass !== void 0) {\n          if (pass instanceof MaskPass) {\n            maskActive = true;\n          } else if (pass instanceof ClearMaskPass) {\n            maskActive = false;\n          }\n        }\n      }\n\n      this.renderer.setRenderTarget(currentRenderTarget);\n    }\n  }, {\n    key: \"reset\",\n    value: function reset(renderTarget) {\n      if (renderTarget === void 0) {\n        var size = this.renderer.getSize(new Vector2());\n        this._pixelRatio = this.renderer.getPixelRatio();\n        this._width = size.width;\n        this._height = size.height;\n        renderTarget = this.renderTarget1.clone();\n        renderTarget.setSize(this._width * this._pixelRatio, this._height * this._pixelRatio);\n      }\n\n      this.renderTarget1.dispose();\n      this.renderTarget2.dispose();\n      this.renderTarget1 = renderTarget;\n      this.renderTarget2 = renderTarget.clone();\n      this.writeBuffer = this.renderTarget1;\n      this.readBuffer = this.renderTarget2;\n    }\n  }, {\n    key: \"setSize\",\n    value: function setSize(width, height) {\n      this._width = width;\n      this._height = height;\n      var effectiveWidth = this._width * this._pixelRatio;\n      var effectiveHeight = this._height * this._pixelRatio;\n      this.renderTarget1.setSize(effectiveWidth, effectiveHeight);\n      this.renderTarget2.setSize(effectiveWidth, effectiveHeight);\n\n      for (var i = 0; i < this.passes.length; i++) {\n        this.passes[i].setSize(effectiveWidth, effectiveHeight);\n      }\n    }\n  }, {\n    key: \"setPixelRatio\",\n    value: function setPixelRatio(pixelRatio) {\n      this._pixelRatio = pixelRatio;\n      this.setSize(this._width, this._height);\n    }\n  }]);\n\n  return EffectComposer;\n}();\n\nexport { EffectComposer };","map":{"version":3,"sources":["/Users/theodaguier/Repositories/E-Do-Studio/node_modules/three-stdlib/postprocessing/EffectComposer.js"],"names":["__defProp","Object","defineProperty","__defNormalProp","obj","key","value","enumerable","configurable","writable","__publicField","LinearFilter","RGBAFormat","Vector2","WebGLRenderTarget","Clock","CopyShader","ShaderPass","MaskPass","ClearMaskPass","EffectComposer","renderer","renderTarget","parameters","minFilter","magFilter","format","size","getSize","_pixelRatio","getPixelRatio","_width","width","_height","height","texture","name","renderTarget1","renderTarget2","clone","writeBuffer","readBuffer","renderToScreen","console","error","copyPass","clock","tmp","pass","passes","push","setSize","index","splice","indexOf","passIndex","i","length","enabled","deltaTime","getDelta","currentRenderTarget","getRenderTarget","maskActive","il","isLastEnabledPass","render","needsSwap","context","getContext","stencil","state","buffers","setFunc","NOTEQUAL","EQUAL","swapBuffers","setRenderTarget","dispose","effectiveWidth","effectiveHeight","pixelRatio"],"mappings":"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","sourcesContent":["var __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nimport { LinearFilter, RGBAFormat, Vector2, WebGLRenderTarget, Clock } from \"three\";\nimport { CopyShader } from \"../shaders/CopyShader.js\";\nimport { ShaderPass } from \"./ShaderPass.js\";\nimport { MaskPass, ClearMaskPass } from \"./MaskPass.js\";\nclass EffectComposer {\n  constructor(renderer, renderTarget) {\n    __publicField(this, \"renderer\");\n    __publicField(this, \"_pixelRatio\");\n    __publicField(this, \"_width\");\n    __publicField(this, \"_height\");\n    __publicField(this, \"renderTarget1\");\n    __publicField(this, \"renderTarget2\");\n    __publicField(this, \"writeBuffer\");\n    __publicField(this, \"readBuffer\");\n    __publicField(this, \"renderToScreen\");\n    __publicField(this, \"passes\", []);\n    __publicField(this, \"copyPass\");\n    __publicField(this, \"clock\");\n    this.renderer = renderer;\n    if (renderTarget === void 0) {\n      const parameters = {\n        minFilter: LinearFilter,\n        magFilter: LinearFilter,\n        format: RGBAFormat\n      };\n      const size = renderer.getSize(new Vector2());\n      this._pixelRatio = renderer.getPixelRatio();\n      this._width = size.width;\n      this._height = size.height;\n      renderTarget = new WebGLRenderTarget(\n        this._width * this._pixelRatio,\n        this._height * this._pixelRatio,\n        parameters\n      );\n      renderTarget.texture.name = \"EffectComposer.rt1\";\n    } else {\n      this._pixelRatio = 1;\n      this._width = renderTarget.width;\n      this._height = renderTarget.height;\n    }\n    this.renderTarget1 = renderTarget;\n    this.renderTarget2 = renderTarget.clone();\n    this.renderTarget2.texture.name = \"EffectComposer.rt2\";\n    this.writeBuffer = this.renderTarget1;\n    this.readBuffer = this.renderTarget2;\n    this.renderToScreen = true;\n    if (CopyShader === void 0) {\n      console.error(\"THREE.EffectComposer relies on CopyShader\");\n    }\n    if (ShaderPass === void 0) {\n      console.error(\"THREE.EffectComposer relies on ShaderPass\");\n    }\n    this.copyPass = new ShaderPass(CopyShader);\n    this.clock = new Clock();\n  }\n  swapBuffers() {\n    const tmp = this.readBuffer;\n    this.readBuffer = this.writeBuffer;\n    this.writeBuffer = tmp;\n  }\n  addPass(pass) {\n    this.passes.push(pass);\n    pass.setSize(this._width * this._pixelRatio, this._height * this._pixelRatio);\n  }\n  insertPass(pass, index) {\n    this.passes.splice(index, 0, pass);\n    pass.setSize(this._width * this._pixelRatio, this._height * this._pixelRatio);\n  }\n  removePass(pass) {\n    const index = this.passes.indexOf(pass);\n    if (index !== -1) {\n      this.passes.splice(index, 1);\n    }\n  }\n  isLastEnabledPass(passIndex) {\n    for (let i = passIndex + 1; i < this.passes.length; i++) {\n      if (this.passes[i].enabled) {\n        return false;\n      }\n    }\n    return true;\n  }\n  render(deltaTime) {\n    if (deltaTime === void 0) {\n      deltaTime = this.clock.getDelta();\n    }\n    const currentRenderTarget = this.renderer.getRenderTarget();\n    let maskActive = false;\n    const il = this.passes.length;\n    for (let i = 0; i < il; i++) {\n      const pass = this.passes[i];\n      if (pass.enabled === false)\n        continue;\n      pass.renderToScreen = this.renderToScreen && this.isLastEnabledPass(i);\n      pass.render(this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive);\n      if (pass.needsSwap) {\n        if (maskActive) {\n          const context = this.renderer.getContext();\n          const stencil = this.renderer.state.buffers.stencil;\n          stencil.setFunc(context.NOTEQUAL, 1, 4294967295);\n          this.copyPass.render(this.renderer, this.writeBuffer, this.readBuffer, deltaTime);\n          stencil.setFunc(context.EQUAL, 1, 4294967295);\n        }\n        this.swapBuffers();\n      }\n      if (MaskPass !== void 0) {\n        if (pass instanceof MaskPass) {\n          maskActive = true;\n        } else if (pass instanceof ClearMaskPass) {\n          maskActive = false;\n        }\n      }\n    }\n    this.renderer.setRenderTarget(currentRenderTarget);\n  }\n  reset(renderTarget) {\n    if (renderTarget === void 0) {\n      const size = this.renderer.getSize(new Vector2());\n      this._pixelRatio = this.renderer.getPixelRatio();\n      this._width = size.width;\n      this._height = size.height;\n      renderTarget = this.renderTarget1.clone();\n      renderTarget.setSize(this._width * this._pixelRatio, this._height * this._pixelRatio);\n    }\n    this.renderTarget1.dispose();\n    this.renderTarget2.dispose();\n    this.renderTarget1 = renderTarget;\n    this.renderTarget2 = renderTarget.clone();\n    this.writeBuffer = this.renderTarget1;\n    this.readBuffer = this.renderTarget2;\n  }\n  setSize(width, height) {\n    this._width = width;\n    this._height = height;\n    const effectiveWidth = this._width * this._pixelRatio;\n    const effectiveHeight = this._height * this._pixelRatio;\n    this.renderTarget1.setSize(effectiveWidth, effectiveHeight);\n    this.renderTarget2.setSize(effectiveWidth, effectiveHeight);\n    for (let i = 0; i < this.passes.length; i++) {\n      this.passes[i].setSize(effectiveWidth, effectiveHeight);\n    }\n  }\n  setPixelRatio(pixelRatio) {\n    this._pixelRatio = pixelRatio;\n    this.setSize(this._width, this._height);\n  }\n}\nexport {\n  EffectComposer\n};\n"]},"metadata":{},"sourceType":"module"}