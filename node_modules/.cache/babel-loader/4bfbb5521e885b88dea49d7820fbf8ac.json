{"ast":null,"code":"import _classCallCheck from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nvar __defProp = Object.defineProperty;\n\nvar __defNormalProp = function __defNormalProp(obj, key, value) {\n  return key in obj ? __defProp(obj, key, {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: value\n  }) : obj[key] = value;\n};\n\nvar __publicField = function __publicField(obj, key, value) {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n\n  return value;\n};\n\nimport { Vector3, Mesh, SkinnedMesh } from \"three\";\n\nvar STLExporter = /*#__PURE__*/function () {\n  function STLExporter() {\n    _classCallCheck(this, STLExporter);\n\n    __publicField(this, \"binary\");\n\n    __publicField(this, \"output\");\n\n    __publicField(this, \"offset\");\n\n    __publicField(this, \"objects\");\n\n    __publicField(this, \"triangles\");\n\n    __publicField(this, \"vA\");\n\n    __publicField(this, \"vB\");\n\n    __publicField(this, \"vC\");\n\n    __publicField(this, \"cb\");\n\n    __publicField(this, \"ab\");\n\n    __publicField(this, \"normal\");\n\n    this.binary = false;\n    this.output = \"\";\n    this.offset = 80;\n    this.objects = [];\n    this.triangles = 0;\n    this.vA = new Vector3();\n    this.vB = new Vector3();\n    this.vC = new Vector3();\n    this.cb = new Vector3();\n    this.ab = new Vector3();\n    this.normal = new Vector3();\n  }\n\n  _createClass(STLExporter, [{\n    key: \"parse\",\n    value: function parse(scene, options) {\n      var _this = this;\n\n      this.binary = options.binary !== void 0 ? options.binary : false;\n      scene.traverse(function (object) {\n        if (object instanceof Mesh && object.isMesh) {\n          var geometry = object.geometry;\n\n          if (!geometry.isBufferGeometry) {\n            throw new Error(\"THREE.STLExporter: Geometry is not of type THREE.BufferGeometry.\");\n          }\n\n          var index = geometry.index;\n          var positionAttribute = geometry.getAttribute(\"position\");\n          _this.triangles += index !== null ? index.count / 3 : positionAttribute.count / 3;\n\n          _this.objects.push({\n            object3d: object,\n            geometry: geometry\n          });\n        }\n      });\n\n      if (this.binary) {\n        var bufferLength = this.triangles * 2 + this.triangles * 3 * 4 * 4 + 80 + 4;\n        var arrayBuffer = new ArrayBuffer(bufferLength);\n        this.output = new DataView(arrayBuffer);\n        this.output.setUint32(this.offset, this.triangles, true);\n        this.offset += 4;\n      } else {\n        this.output = \"\";\n        this.output += \"solid exported\\n\";\n      }\n\n      for (var i = 0, il = this.objects.length; i < il; i++) {\n        var object = this.objects[i].object3d;\n        var geometry = this.objects[i].geometry;\n        var index = geometry.index;\n        var positionAttribute = geometry.getAttribute(\"position\");\n\n        if (object instanceof SkinnedMesh) {\n          if (index !== null) {\n            for (var j = 0; j < index.count; j += 3) {\n              var a = index.getX(j + 0);\n              var b = index.getX(j + 1);\n              var c = index.getX(j + 2);\n              this.writeFace(a, b, c, positionAttribute, object);\n            }\n          } else {\n            for (var _j = 0; _j < positionAttribute.count; _j += 3) {\n              var _a = _j + 0;\n\n              var _b = _j + 1;\n\n              var _c = _j + 2;\n\n              this.writeFace(_a, _b, _c, positionAttribute, object);\n            }\n          }\n        }\n      }\n\n      if (!this.binary) {\n        this.output += \"endsolid exported\\n\";\n      }\n\n      return this.output;\n    }\n  }, {\n    key: \"writeFace\",\n    value: function writeFace(a, b, c, positionAttribute, object) {\n      this.vA.fromBufferAttribute(positionAttribute, a);\n      this.vB.fromBufferAttribute(positionAttribute, b);\n      this.vC.fromBufferAttribute(positionAttribute, c);\n\n      if (object.isSkinnedMesh) {\n        object.boneTransform(a, this.vA);\n        object.boneTransform(b, this.vB);\n        object.boneTransform(c, this.vC);\n      }\n\n      this.vA.applyMatrix4(object.matrixWorld);\n      this.vB.applyMatrix4(object.matrixWorld);\n      this.vC.applyMatrix4(object.matrixWorld);\n      this.writeNormal(this.vA, this.vB, this.vC);\n      this.writeVertex(this.vA);\n      this.writeVertex(this.vB);\n      this.writeVertex(this.vC);\n\n      if (this.binary && this.output instanceof DataView) {\n        this.output.setUint16(this.offset, 0, true);\n        this.offset += 2;\n      } else {\n        this.output += \"\t\tendloop\\n\";\n        this.output += \"\tendfacet\\n\";\n      }\n    }\n  }, {\n    key: \"writeNormal\",\n    value: function writeNormal(vA, vB, vC) {\n      this.cb.subVectors(vC, vB);\n      this.ab.subVectors(vA, vB);\n      this.cb.cross(this.ab).normalize();\n      this.normal.copy(this.cb).normalize();\n\n      if (this.binary && this.output instanceof DataView) {\n        this.output.setFloat32(this.offset, this.normal.x, true);\n        this.offset += 4;\n        this.output.setFloat32(this.offset, this.normal.y, true);\n        this.offset += 4;\n        this.output.setFloat32(this.offset, this.normal.z, true);\n        this.offset += 4;\n      } else {\n        this.output += \"\\tfacet normal \".concat(this.normal.x, \" \").concat(this.normal.y, \" \").concat(this.normal.z, \"\\n\");\n        this.output += \"\t\touter loop\\n\";\n      }\n    }\n  }, {\n    key: \"writeVertex\",\n    value: function writeVertex(vertex) {\n      if (this.binary && this.output instanceof DataView) {\n        this.output.setFloat32(this.offset, vertex.x, true);\n        this.offset += 4;\n        this.output.setFloat32(this.offset, vertex.y, true);\n        this.offset += 4;\n        this.output.setFloat32(this.offset, vertex.z, true);\n        this.offset += 4;\n      } else {\n        this.output += \"\\t\\t\\tvertex vertex.x vertex.y vertex.z\\n\";\n      }\n    }\n  }]);\n\n  return STLExporter;\n}();\n\nexport { STLExporter };","map":{"version":3,"sources":["/Users/theodaguier/Repositories/E-Do-Studio/node_modules/three-stdlib/exporters/STLExporter.js"],"names":["__defProp","Object","defineProperty","__defNormalProp","obj","key","value","enumerable","configurable","writable","__publicField","Vector3","Mesh","SkinnedMesh","STLExporter","binary","output","offset","objects","triangles","vA","vB","vC","cb","ab","normal","scene","options","traverse","object","isMesh","geometry","isBufferGeometry","Error","index","positionAttribute","getAttribute","count","push","object3d","bufferLength","arrayBuffer","ArrayBuffer","DataView","setUint32","i","il","length","j","a","getX","b","c","writeFace","fromBufferAttribute","isSkinnedMesh","boneTransform","applyMatrix4","matrixWorld","writeNormal","writeVertex","setUint16","subVectors","cross","normalize","copy","setFloat32","x","y","z","vertex"],"mappings":"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","sourcesContent":["var __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nimport { Vector3, Mesh, SkinnedMesh } from \"three\";\nclass STLExporter {\n  constructor() {\n    __publicField(this, \"binary\");\n    __publicField(this, \"output\");\n    __publicField(this, \"offset\");\n    __publicField(this, \"objects\");\n    __publicField(this, \"triangles\");\n    __publicField(this, \"vA\");\n    __publicField(this, \"vB\");\n    __publicField(this, \"vC\");\n    __publicField(this, \"cb\");\n    __publicField(this, \"ab\");\n    __publicField(this, \"normal\");\n    this.binary = false;\n    this.output = \"\";\n    this.offset = 80;\n    this.objects = [];\n    this.triangles = 0;\n    this.vA = new Vector3();\n    this.vB = new Vector3();\n    this.vC = new Vector3();\n    this.cb = new Vector3();\n    this.ab = new Vector3();\n    this.normal = new Vector3();\n  }\n  parse(scene, options) {\n    this.binary = options.binary !== void 0 ? options.binary : false;\n    scene.traverse((object) => {\n      if (object instanceof Mesh && object.isMesh) {\n        const geometry = object.geometry;\n        if (!geometry.isBufferGeometry) {\n          throw new Error(\"THREE.STLExporter: Geometry is not of type THREE.BufferGeometry.\");\n        }\n        const index = geometry.index;\n        const positionAttribute = geometry.getAttribute(\"position\");\n        this.triangles += index !== null ? index.count / 3 : positionAttribute.count / 3;\n        this.objects.push({\n          object3d: object,\n          geometry\n        });\n      }\n    });\n    if (this.binary) {\n      const bufferLength = this.triangles * 2 + this.triangles * 3 * 4 * 4 + 80 + 4;\n      const arrayBuffer = new ArrayBuffer(bufferLength);\n      this.output = new DataView(arrayBuffer);\n      this.output.setUint32(this.offset, this.triangles, true);\n      this.offset += 4;\n    } else {\n      this.output = \"\";\n      this.output += \"solid exported\\n\";\n    }\n    for (let i = 0, il = this.objects.length; i < il; i++) {\n      const object = this.objects[i].object3d;\n      const geometry = this.objects[i].geometry;\n      const index = geometry.index;\n      const positionAttribute = geometry.getAttribute(\"position\");\n      if (object instanceof SkinnedMesh) {\n        if (index !== null) {\n          for (let j = 0; j < index.count; j += 3) {\n            const a = index.getX(j + 0);\n            const b = index.getX(j + 1);\n            const c = index.getX(j + 2);\n            this.writeFace(a, b, c, positionAttribute, object);\n          }\n        } else {\n          for (let j = 0; j < positionAttribute.count; j += 3) {\n            const a = j + 0;\n            const b = j + 1;\n            const c = j + 2;\n            this.writeFace(a, b, c, positionAttribute, object);\n          }\n        }\n      }\n    }\n    if (!this.binary) {\n      this.output += \"endsolid exported\\n\";\n    }\n    return this.output;\n  }\n  writeFace(a, b, c, positionAttribute, object) {\n    this.vA.fromBufferAttribute(positionAttribute, a);\n    this.vB.fromBufferAttribute(positionAttribute, b);\n    this.vC.fromBufferAttribute(positionAttribute, c);\n    if (object.isSkinnedMesh) {\n      object.boneTransform(a, this.vA);\n      object.boneTransform(b, this.vB);\n      object.boneTransform(c, this.vC);\n    }\n    this.vA.applyMatrix4(object.matrixWorld);\n    this.vB.applyMatrix4(object.matrixWorld);\n    this.vC.applyMatrix4(object.matrixWorld);\n    this.writeNormal(this.vA, this.vB, this.vC);\n    this.writeVertex(this.vA);\n    this.writeVertex(this.vB);\n    this.writeVertex(this.vC);\n    if (this.binary && this.output instanceof DataView) {\n      this.output.setUint16(this.offset, 0, true);\n      this.offset += 2;\n    } else {\n      this.output += \"\t\tendloop\\n\";\n      this.output += \"\tendfacet\\n\";\n    }\n  }\n  writeNormal(vA, vB, vC) {\n    this.cb.subVectors(vC, vB);\n    this.ab.subVectors(vA, vB);\n    this.cb.cross(this.ab).normalize();\n    this.normal.copy(this.cb).normalize();\n    if (this.binary && this.output instanceof DataView) {\n      this.output.setFloat32(this.offset, this.normal.x, true);\n      this.offset += 4;\n      this.output.setFloat32(this.offset, this.normal.y, true);\n      this.offset += 4;\n      this.output.setFloat32(this.offset, this.normal.z, true);\n      this.offset += 4;\n    } else {\n      this.output += `\tfacet normal ${this.normal.x} ${this.normal.y} ${this.normal.z}\n`;\n      this.output += \"\t\touter loop\\n\";\n    }\n  }\n  writeVertex(vertex) {\n    if (this.binary && this.output instanceof DataView) {\n      this.output.setFloat32(this.offset, vertex.x, true);\n      this.offset += 4;\n      this.output.setFloat32(this.offset, vertex.y, true);\n      this.offset += 4;\n      this.output.setFloat32(this.offset, vertex.z, true);\n      this.offset += 4;\n    } else {\n      this.output += `\t\t\tvertex vertex.x vertex.y vertex.z\n`;\n    }\n  }\n}\nexport {\n  STLExporter\n};\n"]},"metadata":{},"sourceType":"module"}