{"ast":null,"code":"import _classCallCheck from \"/Users/theodaguier/_dev/pro/e-do/website/old/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/theodaguier/_dev/pro/e-do/website/old/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/theodaguier/_dev/pro/e-do/website/old/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/theodaguier/_dev/pro/e-do/website/old/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Loader, FileLoader, BufferGeometry, Vector3, Float32BufferAttribute, AnimationClip } from \"three\";\nvar _normalData = [[-0.525731, 0, 0.850651], [-0.442863, 0.238856, 0.864188], [-0.295242, 0, 0.955423], [-0.309017, 0.5, 0.809017], [-0.16246, 0.262866, 0.951056], [0, 0, 1], [0, 0.850651, 0.525731], [-0.147621, 0.716567, 0.681718], [0.147621, 0.716567, 0.681718], [0, 0.525731, 0.850651], [0.309017, 0.5, 0.809017], [0.525731, 0, 0.850651], [0.295242, 0, 0.955423], [0.442863, 0.238856, 0.864188], [0.16246, 0.262866, 0.951056], [-0.681718, 0.147621, 0.716567], [-0.809017, 0.309017, 0.5], [-0.587785, 0.425325, 0.688191], [-0.850651, 0.525731, 0], [-0.864188, 0.442863, 0.238856], [-0.716567, 0.681718, 0.147621], [-0.688191, 0.587785, 0.425325], [-0.5, 0.809017, 0.309017], [-0.238856, 0.864188, 0.442863], [-0.425325, 0.688191, 0.587785], [-0.716567, 0.681718, -0.147621], [-0.5, 0.809017, -0.309017], [-0.525731, 0.850651, 0], [0, 0.850651, -0.525731], [-0.238856, 0.864188, -0.442863], [0, 0.955423, -0.295242], [-0.262866, 0.951056, -0.16246], [0, 1, 0], [0, 0.955423, 0.295242], [-0.262866, 0.951056, 0.16246], [0.238856, 0.864188, 0.442863], [0.262866, 0.951056, 0.16246], [0.5, 0.809017, 0.309017], [0.238856, 0.864188, -0.442863], [0.262866, 0.951056, -0.16246], [0.5, 0.809017, -0.309017], [0.850651, 0.525731, 0], [0.716567, 0.681718, 0.147621], [0.716567, 0.681718, -0.147621], [0.525731, 0.850651, 0], [0.425325, 0.688191, 0.587785], [0.864188, 0.442863, 0.238856], [0.688191, 0.587785, 0.425325], [0.809017, 0.309017, 0.5], [0.681718, 0.147621, 0.716567], [0.587785, 0.425325, 0.688191], [0.955423, 0.295242, 0], [1, 0, 0], [0.951056, 0.16246, 0.262866], [0.850651, -0.525731, 0], [0.955423, -0.295242, 0], [0.864188, -0.442863, 0.238856], [0.951056, -0.16246, 0.262866], [0.809017, -0.309017, 0.5], [0.681718, -0.147621, 0.716567], [0.850651, 0, 0.525731], [0.864188, 0.442863, -0.238856], [0.809017, 0.309017, -0.5], [0.951056, 0.16246, -0.262866], [0.525731, 0, -0.850651], [0.681718, 0.147621, -0.716567], [0.681718, -0.147621, -0.716567], [0.850651, 0, -0.525731], [0.809017, -0.309017, -0.5], [0.864188, -0.442863, -0.238856], [0.951056, -0.16246, -0.262866], [0.147621, 0.716567, -0.681718], [0.309017, 0.5, -0.809017], [0.425325, 0.688191, -0.587785], [0.442863, 0.238856, -0.864188], [0.587785, 0.425325, -0.688191], [0.688191, 0.587785, -0.425325], [-0.147621, 0.716567, -0.681718], [-0.309017, 0.5, -0.809017], [0, 0.525731, -0.850651], [-0.525731, 0, -0.850651], [-0.442863, 0.238856, -0.864188], [-0.295242, 0, -0.955423], [-0.16246, 0.262866, -0.951056], [0, 0, -1], [0.295242, 0, -0.955423], [0.16246, 0.262866, -0.951056], [-0.442863, -0.238856, -0.864188], [-0.309017, -0.5, -0.809017], [-0.16246, -0.262866, -0.951056], [0, -0.850651, -0.525731], [-0.147621, -0.716567, -0.681718], [0.147621, -0.716567, -0.681718], [0, -0.525731, -0.850651], [0.309017, -0.5, -0.809017], [0.442863, -0.238856, -0.864188], [0.16246, -0.262866, -0.951056], [0.238856, -0.864188, -0.442863], [0.5, -0.809017, -0.309017], [0.425325, -0.688191, -0.587785], [0.716567, -0.681718, -0.147621], [0.688191, -0.587785, -0.425325], [0.587785, -0.425325, -0.688191], [0, -0.955423, -0.295242], [0, -1, 0], [0.262866, -0.951056, -0.16246], [0, -0.850651, 0.525731], [0, -0.955423, 0.295242], [0.238856, -0.864188, 0.442863], [0.262866, -0.951056, 0.16246], [0.5, -0.809017, 0.309017], [0.716567, -0.681718, 0.147621], [0.525731, -0.850651, 0], [-0.238856, -0.864188, -0.442863], [-0.5, -0.809017, -0.309017], [-0.262866, -0.951056, -0.16246], [-0.850651, -0.525731, 0], [-0.716567, -0.681718, -0.147621], [-0.716567, -0.681718, 0.147621], [-0.525731, -0.850651, 0], [-0.5, -0.809017, 0.309017], [-0.238856, -0.864188, 0.442863], [-0.262866, -0.951056, 0.16246], [-0.864188, -0.442863, 0.238856], [-0.809017, -0.309017, 0.5], [-0.688191, -0.587785, 0.425325], [-0.681718, -0.147621, 0.716567], [-0.442863, -0.238856, 0.864188], [-0.587785, -0.425325, 0.688191], [-0.309017, -0.5, 0.809017], [-0.147621, -0.716567, 0.681718], [-0.425325, -0.688191, 0.587785], [-0.16246, -0.262866, 0.951056], [0.442863, -0.238856, 0.864188], [0.16246, -0.262866, 0.951056], [0.309017, -0.5, 0.809017], [0.147621, -0.716567, 0.681718], [0, -0.525731, 0.850651], [0.425325, -0.688191, 0.587785], [0.587785, -0.425325, 0.688191], [0.688191, -0.587785, 0.425325], [-0.955423, 0.295242, 0], [-0.951056, 0.16246, 0.262866], [-1, 0, 0], [-0.850651, 0, 0.525731], [-0.955423, -0.295242, 0], [-0.951056, -0.16246, 0.262866], [-0.864188, 0.442863, -0.238856], [-0.951056, 0.16246, -0.262866], [-0.809017, 0.309017, -0.5], [-0.864188, -0.442863, -0.238856], [-0.951056, -0.16246, -0.262866], [-0.809017, -0.309017, -0.5], [-0.681718, 0.147621, -0.716567], [-0.681718, -0.147621, -0.716567], [-0.850651, 0, -0.525731], [-0.688191, 0.587785, -0.425325], [-0.587785, 0.425325, -0.688191], [-0.425325, 0.688191, -0.587785], [-0.425325, -0.688191, -0.587785], [-0.587785, -0.425325, -0.688191], [-0.688191, -0.587785, -0.425325]];\n\nvar MD2Loader = /*#__PURE__*/function (_Loader) {\n  _inherits(MD2Loader, _Loader);\n\n  var _super = _createSuper(MD2Loader);\n\n  function MD2Loader(manager) {\n    _classCallCheck(this, MD2Loader);\n\n    return _super.call(this, manager);\n  }\n\n  _createClass(MD2Loader, [{\n    key: \"load\",\n    value: function load(url, onLoad, onProgress, onError) {\n      var scope = this;\n      var loader = new FileLoader(scope.manager);\n      loader.setPath(scope.path);\n      loader.setResponseType(\"arraybuffer\");\n      loader.setRequestHeader(scope.requestHeader);\n      loader.setWithCredentials(scope.withCredentials);\n      loader.load(url, function (buffer) {\n        try {\n          onLoad(scope.parse(buffer));\n        } catch (e) {\n          if (onError) {\n            onError(e);\n          } else {\n            console.error(e);\n          }\n\n          scope.manager.itemError(url);\n        }\n      }, onProgress, onError);\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(buffer) {\n      var data = new DataView(buffer);\n      var header = {};\n      var headerNames = [\"ident\", \"version\", \"skinwidth\", \"skinheight\", \"framesize\", \"num_skins\", \"num_vertices\", \"num_st\", \"num_tris\", \"num_glcmds\", \"num_frames\", \"offset_skins\", \"offset_st\", \"offset_tris\", \"offset_frames\", \"offset_glcmds\", \"offset_end\"];\n\n      for (var i = 0; i < headerNames.length; i++) {\n        header[headerNames[i]] = data.getInt32(i * 4, true);\n      }\n\n      if (header.ident !== 844121161 || header.version !== 8) {\n        console.error(\"Not a valid MD2 file\");\n        return;\n      }\n\n      if (header.offset_end !== data.byteLength) {\n        console.error(\"Corrupted MD2 file\");\n        return;\n      }\n\n      var geometry = new BufferGeometry();\n      var uvsTemp = [];\n      var offset = header.offset_st;\n\n      for (var _i = 0, l = header.num_st; _i < l; _i++) {\n        var u = data.getInt16(offset + 0, true);\n        var v = data.getInt16(offset + 2, true);\n        uvsTemp.push(u / header.skinwidth, 1 - v / header.skinheight);\n        offset += 4;\n      }\n\n      offset = header.offset_tris;\n      var vertexIndices = [];\n      var uvIndices = [];\n\n      for (var _i2 = 0, _l = header.num_tris; _i2 < _l; _i2++) {\n        vertexIndices.push(data.getUint16(offset + 0, true), data.getUint16(offset + 2, true), data.getUint16(offset + 4, true));\n        uvIndices.push(data.getUint16(offset + 6, true), data.getUint16(offset + 8, true), data.getUint16(offset + 10, true));\n        offset += 12;\n      }\n\n      var translation = new Vector3();\n      var scale = new Vector3();\n      var string = [];\n      var frames = [];\n      offset = header.offset_frames;\n\n      for (var _i3 = 0, _l2 = header.num_frames; _i3 < _l2; _i3++) {\n        scale.set(data.getFloat32(offset + 0, true), data.getFloat32(offset + 4, true), data.getFloat32(offset + 8, true));\n        translation.set(data.getFloat32(offset + 12, true), data.getFloat32(offset + 16, true), data.getFloat32(offset + 20, true));\n        offset += 24;\n\n        for (var j = 0; j < 16; j++) {\n          var character = data.getUint8(offset + j, true);\n          if (character === 0) break;\n          string[j] = character;\n        }\n\n        var frame = {\n          name: String.fromCharCode.apply(null, string),\n          vertices: [],\n          normals: []\n        };\n        offset += 16;\n\n        for (var _j = 0; _j < header.num_vertices; _j++) {\n          var x = data.getUint8(offset++, true);\n          var y = data.getUint8(offset++, true);\n          var z = data.getUint8(offset++, true);\n\n          var n = _normalData[data.getUint8(offset++, true)];\n\n          x = x * scale.x + translation.x;\n          y = y * scale.y + translation.y;\n          z = z * scale.z + translation.z;\n          frame.vertices.push(x, z, y);\n          frame.normals.push(n[0], n[2], n[1]);\n        }\n\n        frames.push(frame);\n      }\n\n      var positions = [];\n      var normals = [];\n      var uvs = [];\n      var verticesTemp = frames[0].vertices;\n      var normalsTemp = frames[0].normals;\n\n      for (var _i4 = 0, _l3 = vertexIndices.length; _i4 < _l3; _i4++) {\n        var vertexIndex = vertexIndices[_i4];\n        var stride = vertexIndex * 3;\n        var _x = verticesTemp[stride];\n        var _y = verticesTemp[stride + 1];\n        var _z = verticesTemp[stride + 2];\n        positions.push(_x, _y, _z);\n        var nx = normalsTemp[stride];\n        var ny = normalsTemp[stride + 1];\n        var nz = normalsTemp[stride + 2];\n        normals.push(nx, ny, nz);\n        var uvIndex = uvIndices[_i4];\n        stride = uvIndex * 2;\n        var _u = uvsTemp[stride];\n        var _v = uvsTemp[stride + 1];\n        uvs.push(_u, _v);\n      }\n\n      geometry.setAttribute(\"position\", new Float32BufferAttribute(positions, 3));\n      geometry.setAttribute(\"normal\", new Float32BufferAttribute(normals, 3));\n      geometry.setAttribute(\"uv\", new Float32BufferAttribute(uvs, 2));\n      var morphPositions = [];\n      var morphNormals = [];\n\n      for (var _i5 = 0, _l4 = frames.length; _i5 < _l4; _i5++) {\n        var _frame = frames[_i5];\n        var attributeName = _frame.name;\n\n        if (_frame.vertices.length > 0) {\n          var positions2 = [];\n\n          for (var _j2 = 0, jl = vertexIndices.length; _j2 < jl; _j2++) {\n            var _vertexIndex = vertexIndices[_j2];\n\n            var _stride = _vertexIndex * 3;\n\n            var _x2 = _frame.vertices[_stride];\n            var _y2 = _frame.vertices[_stride + 1];\n            var _z2 = _frame.vertices[_stride + 2];\n            positions2.push(_x2, _y2, _z2);\n          }\n\n          var positionAttribute = new Float32BufferAttribute(positions2, 3);\n          positionAttribute.name = attributeName;\n          morphPositions.push(positionAttribute);\n        }\n\n        if (_frame.normals.length > 0) {\n          var normals2 = [];\n\n          for (var _j3 = 0, _jl = vertexIndices.length; _j3 < _jl; _j3++) {\n            var _vertexIndex2 = vertexIndices[_j3];\n\n            var _stride2 = _vertexIndex2 * 3;\n\n            var _nx = _frame.normals[_stride2];\n            var _ny = _frame.normals[_stride2 + 1];\n            var _nz = _frame.normals[_stride2 + 2];\n            normals2.push(_nx, _ny, _nz);\n          }\n\n          var normalAttribute = new Float32BufferAttribute(normals2, 3);\n          normalAttribute.name = attributeName;\n          morphNormals.push(normalAttribute);\n        }\n      }\n\n      geometry.morphAttributes.position = morphPositions;\n      geometry.morphAttributes.normal = morphNormals;\n      geometry.morphTargetsRelative = false;\n      geometry.animations = AnimationClip.CreateClipsFromMorphTargetSequences(frames, 10);\n      return geometry;\n    }\n  }]);\n\n  return MD2Loader;\n}(Loader);\n\nexport { MD2Loader };","map":{"version":3,"sources":["/Users/theodaguier/_dev/pro/e-do/website/old/E-Do-Studio/node_modules/three-stdlib/loaders/MD2Loader.js"],"names":["Loader","FileLoader","BufferGeometry","Vector3","Float32BufferAttribute","AnimationClip","_normalData","MD2Loader","manager","url","onLoad","onProgress","onError","scope","loader","setPath","path","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","load","buffer","parse","e","console","error","itemError","data","DataView","header","headerNames","i","length","getInt32","ident","version","offset_end","byteLength","geometry","uvsTemp","offset","offset_st","l","num_st","u","getInt16","v","push","skinwidth","skinheight","offset_tris","vertexIndices","uvIndices","num_tris","getUint16","translation","scale","string","frames","offset_frames","num_frames","set","getFloat32","j","character","getUint8","frame","name","String","fromCharCode","apply","vertices","normals","num_vertices","x","y","z","n","positions","uvs","verticesTemp","normalsTemp","vertexIndex","stride","nx","ny","nz","uvIndex","setAttribute","morphPositions","morphNormals","attributeName","positions2","jl","positionAttribute","normals2","normalAttribute","morphAttributes","position","normal","morphTargetsRelative","animations","CreateClipsFromMorphTargetSequences"],"mappings":"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","sourcesContent":["import { Loader, FileLoader, BufferGeometry, Vector3, Float32BufferAttribute, AnimationClip } from \"three\";\nconst _normalData = [\n  [-0.525731, 0, 0.850651],\n  [-0.442863, 0.238856, 0.864188],\n  [-0.295242, 0, 0.955423],\n  [-0.309017, 0.5, 0.809017],\n  [-0.16246, 0.262866, 0.951056],\n  [0, 0, 1],\n  [0, 0.850651, 0.525731],\n  [-0.147621, 0.716567, 0.681718],\n  [0.147621, 0.716567, 0.681718],\n  [0, 0.525731, 0.850651],\n  [0.309017, 0.5, 0.809017],\n  [0.525731, 0, 0.850651],\n  [0.295242, 0, 0.955423],\n  [0.442863, 0.238856, 0.864188],\n  [0.16246, 0.262866, 0.951056],\n  [-0.681718, 0.147621, 0.716567],\n  [-0.809017, 0.309017, 0.5],\n  [-0.587785, 0.425325, 0.688191],\n  [-0.850651, 0.525731, 0],\n  [-0.864188, 0.442863, 0.238856],\n  [-0.716567, 0.681718, 0.147621],\n  [-0.688191, 0.587785, 0.425325],\n  [-0.5, 0.809017, 0.309017],\n  [-0.238856, 0.864188, 0.442863],\n  [-0.425325, 0.688191, 0.587785],\n  [-0.716567, 0.681718, -0.147621],\n  [-0.5, 0.809017, -0.309017],\n  [-0.525731, 0.850651, 0],\n  [0, 0.850651, -0.525731],\n  [-0.238856, 0.864188, -0.442863],\n  [0, 0.955423, -0.295242],\n  [-0.262866, 0.951056, -0.16246],\n  [0, 1, 0],\n  [0, 0.955423, 0.295242],\n  [-0.262866, 0.951056, 0.16246],\n  [0.238856, 0.864188, 0.442863],\n  [0.262866, 0.951056, 0.16246],\n  [0.5, 0.809017, 0.309017],\n  [0.238856, 0.864188, -0.442863],\n  [0.262866, 0.951056, -0.16246],\n  [0.5, 0.809017, -0.309017],\n  [0.850651, 0.525731, 0],\n  [0.716567, 0.681718, 0.147621],\n  [0.716567, 0.681718, -0.147621],\n  [0.525731, 0.850651, 0],\n  [0.425325, 0.688191, 0.587785],\n  [0.864188, 0.442863, 0.238856],\n  [0.688191, 0.587785, 0.425325],\n  [0.809017, 0.309017, 0.5],\n  [0.681718, 0.147621, 0.716567],\n  [0.587785, 0.425325, 0.688191],\n  [0.955423, 0.295242, 0],\n  [1, 0, 0],\n  [0.951056, 0.16246, 0.262866],\n  [0.850651, -0.525731, 0],\n  [0.955423, -0.295242, 0],\n  [0.864188, -0.442863, 0.238856],\n  [0.951056, -0.16246, 0.262866],\n  [0.809017, -0.309017, 0.5],\n  [0.681718, -0.147621, 0.716567],\n  [0.850651, 0, 0.525731],\n  [0.864188, 0.442863, -0.238856],\n  [0.809017, 0.309017, -0.5],\n  [0.951056, 0.16246, -0.262866],\n  [0.525731, 0, -0.850651],\n  [0.681718, 0.147621, -0.716567],\n  [0.681718, -0.147621, -0.716567],\n  [0.850651, 0, -0.525731],\n  [0.809017, -0.309017, -0.5],\n  [0.864188, -0.442863, -0.238856],\n  [0.951056, -0.16246, -0.262866],\n  [0.147621, 0.716567, -0.681718],\n  [0.309017, 0.5, -0.809017],\n  [0.425325, 0.688191, -0.587785],\n  [0.442863, 0.238856, -0.864188],\n  [0.587785, 0.425325, -0.688191],\n  [0.688191, 0.587785, -0.425325],\n  [-0.147621, 0.716567, -0.681718],\n  [-0.309017, 0.5, -0.809017],\n  [0, 0.525731, -0.850651],\n  [-0.525731, 0, -0.850651],\n  [-0.442863, 0.238856, -0.864188],\n  [-0.295242, 0, -0.955423],\n  [-0.16246, 0.262866, -0.951056],\n  [0, 0, -1],\n  [0.295242, 0, -0.955423],\n  [0.16246, 0.262866, -0.951056],\n  [-0.442863, -0.238856, -0.864188],\n  [-0.309017, -0.5, -0.809017],\n  [-0.16246, -0.262866, -0.951056],\n  [0, -0.850651, -0.525731],\n  [-0.147621, -0.716567, -0.681718],\n  [0.147621, -0.716567, -0.681718],\n  [0, -0.525731, -0.850651],\n  [0.309017, -0.5, -0.809017],\n  [0.442863, -0.238856, -0.864188],\n  [0.16246, -0.262866, -0.951056],\n  [0.238856, -0.864188, -0.442863],\n  [0.5, -0.809017, -0.309017],\n  [0.425325, -0.688191, -0.587785],\n  [0.716567, -0.681718, -0.147621],\n  [0.688191, -0.587785, -0.425325],\n  [0.587785, -0.425325, -0.688191],\n  [0, -0.955423, -0.295242],\n  [0, -1, 0],\n  [0.262866, -0.951056, -0.16246],\n  [0, -0.850651, 0.525731],\n  [0, -0.955423, 0.295242],\n  [0.238856, -0.864188, 0.442863],\n  [0.262866, -0.951056, 0.16246],\n  [0.5, -0.809017, 0.309017],\n  [0.716567, -0.681718, 0.147621],\n  [0.525731, -0.850651, 0],\n  [-0.238856, -0.864188, -0.442863],\n  [-0.5, -0.809017, -0.309017],\n  [-0.262866, -0.951056, -0.16246],\n  [-0.850651, -0.525731, 0],\n  [-0.716567, -0.681718, -0.147621],\n  [-0.716567, -0.681718, 0.147621],\n  [-0.525731, -0.850651, 0],\n  [-0.5, -0.809017, 0.309017],\n  [-0.238856, -0.864188, 0.442863],\n  [-0.262866, -0.951056, 0.16246],\n  [-0.864188, -0.442863, 0.238856],\n  [-0.809017, -0.309017, 0.5],\n  [-0.688191, -0.587785, 0.425325],\n  [-0.681718, -0.147621, 0.716567],\n  [-0.442863, -0.238856, 0.864188],\n  [-0.587785, -0.425325, 0.688191],\n  [-0.309017, -0.5, 0.809017],\n  [-0.147621, -0.716567, 0.681718],\n  [-0.425325, -0.688191, 0.587785],\n  [-0.16246, -0.262866, 0.951056],\n  [0.442863, -0.238856, 0.864188],\n  [0.16246, -0.262866, 0.951056],\n  [0.309017, -0.5, 0.809017],\n  [0.147621, -0.716567, 0.681718],\n  [0, -0.525731, 0.850651],\n  [0.425325, -0.688191, 0.587785],\n  [0.587785, -0.425325, 0.688191],\n  [0.688191, -0.587785, 0.425325],\n  [-0.955423, 0.295242, 0],\n  [-0.951056, 0.16246, 0.262866],\n  [-1, 0, 0],\n  [-0.850651, 0, 0.525731],\n  [-0.955423, -0.295242, 0],\n  [-0.951056, -0.16246, 0.262866],\n  [-0.864188, 0.442863, -0.238856],\n  [-0.951056, 0.16246, -0.262866],\n  [-0.809017, 0.309017, -0.5],\n  [-0.864188, -0.442863, -0.238856],\n  [-0.951056, -0.16246, -0.262866],\n  [-0.809017, -0.309017, -0.5],\n  [-0.681718, 0.147621, -0.716567],\n  [-0.681718, -0.147621, -0.716567],\n  [-0.850651, 0, -0.525731],\n  [-0.688191, 0.587785, -0.425325],\n  [-0.587785, 0.425325, -0.688191],\n  [-0.425325, 0.688191, -0.587785],\n  [-0.425325, -0.688191, -0.587785],\n  [-0.587785, -0.425325, -0.688191],\n  [-0.688191, -0.587785, -0.425325]\n];\nclass MD2Loader extends Loader {\n  constructor(manager) {\n    super(manager);\n  }\n  load(url, onLoad, onProgress, onError) {\n    const scope = this;\n    const loader = new FileLoader(scope.manager);\n    loader.setPath(scope.path);\n    loader.setResponseType(\"arraybuffer\");\n    loader.setRequestHeader(scope.requestHeader);\n    loader.setWithCredentials(scope.withCredentials);\n    loader.load(\n      url,\n      function(buffer) {\n        try {\n          onLoad(scope.parse(buffer));\n        } catch (e) {\n          if (onError) {\n            onError(e);\n          } else {\n            console.error(e);\n          }\n          scope.manager.itemError(url);\n        }\n      },\n      onProgress,\n      onError\n    );\n  }\n  parse(buffer) {\n    const data = new DataView(buffer);\n    const header = {};\n    const headerNames = [\n      \"ident\",\n      \"version\",\n      \"skinwidth\",\n      \"skinheight\",\n      \"framesize\",\n      \"num_skins\",\n      \"num_vertices\",\n      \"num_st\",\n      \"num_tris\",\n      \"num_glcmds\",\n      \"num_frames\",\n      \"offset_skins\",\n      \"offset_st\",\n      \"offset_tris\",\n      \"offset_frames\",\n      \"offset_glcmds\",\n      \"offset_end\"\n    ];\n    for (let i = 0; i < headerNames.length; i++) {\n      header[headerNames[i]] = data.getInt32(i * 4, true);\n    }\n    if (header.ident !== 844121161 || header.version !== 8) {\n      console.error(\"Not a valid MD2 file\");\n      return;\n    }\n    if (header.offset_end !== data.byteLength) {\n      console.error(\"Corrupted MD2 file\");\n      return;\n    }\n    const geometry = new BufferGeometry();\n    const uvsTemp = [];\n    let offset = header.offset_st;\n    for (let i = 0, l = header.num_st; i < l; i++) {\n      const u = data.getInt16(offset + 0, true);\n      const v = data.getInt16(offset + 2, true);\n      uvsTemp.push(u / header.skinwidth, 1 - v / header.skinheight);\n      offset += 4;\n    }\n    offset = header.offset_tris;\n    const vertexIndices = [];\n    const uvIndices = [];\n    for (let i = 0, l = header.num_tris; i < l; i++) {\n      vertexIndices.push(\n        data.getUint16(offset + 0, true),\n        data.getUint16(offset + 2, true),\n        data.getUint16(offset + 4, true)\n      );\n      uvIndices.push(\n        data.getUint16(offset + 6, true),\n        data.getUint16(offset + 8, true),\n        data.getUint16(offset + 10, true)\n      );\n      offset += 12;\n    }\n    const translation = new Vector3();\n    const scale = new Vector3();\n    const string = [];\n    const frames = [];\n    offset = header.offset_frames;\n    for (let i = 0, l = header.num_frames; i < l; i++) {\n      scale.set(data.getFloat32(offset + 0, true), data.getFloat32(offset + 4, true), data.getFloat32(offset + 8, true));\n      translation.set(\n        data.getFloat32(offset + 12, true),\n        data.getFloat32(offset + 16, true),\n        data.getFloat32(offset + 20, true)\n      );\n      offset += 24;\n      for (let j = 0; j < 16; j++) {\n        const character = data.getUint8(offset + j, true);\n        if (character === 0)\n          break;\n        string[j] = character;\n      }\n      const frame = {\n        name: String.fromCharCode.apply(null, string),\n        vertices: [],\n        normals: []\n      };\n      offset += 16;\n      for (let j = 0; j < header.num_vertices; j++) {\n        let x = data.getUint8(offset++, true);\n        let y = data.getUint8(offset++, true);\n        let z = data.getUint8(offset++, true);\n        const n = _normalData[data.getUint8(offset++, true)];\n        x = x * scale.x + translation.x;\n        y = y * scale.y + translation.y;\n        z = z * scale.z + translation.z;\n        frame.vertices.push(x, z, y);\n        frame.normals.push(n[0], n[2], n[1]);\n      }\n      frames.push(frame);\n    }\n    const positions = [];\n    const normals = [];\n    const uvs = [];\n    const verticesTemp = frames[0].vertices;\n    const normalsTemp = frames[0].normals;\n    for (let i = 0, l = vertexIndices.length; i < l; i++) {\n      const vertexIndex = vertexIndices[i];\n      let stride = vertexIndex * 3;\n      const x = verticesTemp[stride];\n      const y = verticesTemp[stride + 1];\n      const z = verticesTemp[stride + 2];\n      positions.push(x, y, z);\n      const nx = normalsTemp[stride];\n      const ny = normalsTemp[stride + 1];\n      const nz = normalsTemp[stride + 2];\n      normals.push(nx, ny, nz);\n      const uvIndex = uvIndices[i];\n      stride = uvIndex * 2;\n      const u = uvsTemp[stride];\n      const v = uvsTemp[stride + 1];\n      uvs.push(u, v);\n    }\n    geometry.setAttribute(\"position\", new Float32BufferAttribute(positions, 3));\n    geometry.setAttribute(\"normal\", new Float32BufferAttribute(normals, 3));\n    geometry.setAttribute(\"uv\", new Float32BufferAttribute(uvs, 2));\n    const morphPositions = [];\n    const morphNormals = [];\n    for (let i = 0, l = frames.length; i < l; i++) {\n      const frame = frames[i];\n      const attributeName = frame.name;\n      if (frame.vertices.length > 0) {\n        const positions2 = [];\n        for (let j = 0, jl = vertexIndices.length; j < jl; j++) {\n          const vertexIndex = vertexIndices[j];\n          const stride = vertexIndex * 3;\n          const x = frame.vertices[stride];\n          const y = frame.vertices[stride + 1];\n          const z = frame.vertices[stride + 2];\n          positions2.push(x, y, z);\n        }\n        const positionAttribute = new Float32BufferAttribute(positions2, 3);\n        positionAttribute.name = attributeName;\n        morphPositions.push(positionAttribute);\n      }\n      if (frame.normals.length > 0) {\n        const normals2 = [];\n        for (let j = 0, jl = vertexIndices.length; j < jl; j++) {\n          const vertexIndex = vertexIndices[j];\n          const stride = vertexIndex * 3;\n          const nx = frame.normals[stride];\n          const ny = frame.normals[stride + 1];\n          const nz = frame.normals[stride + 2];\n          normals2.push(nx, ny, nz);\n        }\n        const normalAttribute = new Float32BufferAttribute(normals2, 3);\n        normalAttribute.name = attributeName;\n        morphNormals.push(normalAttribute);\n      }\n    }\n    geometry.morphAttributes.position = morphPositions;\n    geometry.morphAttributes.normal = morphNormals;\n    geometry.morphTargetsRelative = false;\n    geometry.animations = AnimationClip.CreateClipsFromMorphTargetSequences(frames, 10);\n    return geometry;\n  }\n}\nexport {\n  MD2Loader\n};\n"]},"metadata":{},"sourceType":"module"}