{"ast":null,"code":"import _classCallCheck from \"/Users/theodaguier/_workdir/dev/pro/e-do/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _assertThisInitialized from \"/Users/theodaguier/_workdir/dev/pro/e-do/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/theodaguier/_workdir/dev/pro/e-do/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/theodaguier/_workdir/dev/pro/e-do/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar __defProp = Object.defineProperty;\n\nvar __defNormalProp = function __defNormalProp(obj, key, value) {\n  return key in obj ? __defProp(obj, key, {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: value\n  }) : obj[key] = value;\n};\n\nvar __publicField = function __publicField(obj, key, value) {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n\n  return value;\n};\n\nimport { EventDispatcher, Plane, Raycaster, Vector2, Vector3, Matrix4 } from \"three\";\n\nvar DragControls = /*#__PURE__*/function (_EventDispatcher) {\n  _inherits(DragControls, _EventDispatcher);\n\n  var _super = _createSuper(DragControls);\n\n  function DragControls(_objects, _camera, _domElement) {\n    var _this;\n\n    _classCallCheck(this, DragControls);\n\n    _this = _super.call(this);\n\n    __publicField(_assertThisInitialized(_this), \"enabled\", true);\n\n    __publicField(_assertThisInitialized(_this), \"transformGroup\", false);\n\n    __publicField(_assertThisInitialized(_this), \"_objects\");\n\n    __publicField(_assertThisInitialized(_this), \"_camera\");\n\n    __publicField(_assertThisInitialized(_this), \"_domElement\");\n\n    __publicField(_assertThisInitialized(_this), \"_plane\", new Plane());\n\n    __publicField(_assertThisInitialized(_this), \"_raycaster\", new Raycaster());\n\n    __publicField(_assertThisInitialized(_this), \"_mouse\", new Vector2());\n\n    __publicField(_assertThisInitialized(_this), \"_offset\", new Vector3());\n\n    __publicField(_assertThisInitialized(_this), \"_intersection\", new Vector3());\n\n    __publicField(_assertThisInitialized(_this), \"_worldPosition\", new Vector3());\n\n    __publicField(_assertThisInitialized(_this), \"_inverseMatrix\", new Matrix4());\n\n    __publicField(_assertThisInitialized(_this), \"_intersections\", []);\n\n    __publicField(_assertThisInitialized(_this), \"_selected\", null);\n\n    __publicField(_assertThisInitialized(_this), \"_hovered\", null);\n\n    __publicField(_assertThisInitialized(_this), \"activate\", function () {\n      _this._domElement.addEventListener(\"pointermove\", _this.onPointerMove);\n\n      _this._domElement.addEventListener(\"pointerdown\", _this.onPointerDown);\n\n      _this._domElement.addEventListener(\"pointerup\", _this.onPointerCancel);\n\n      _this._domElement.addEventListener(\"pointerleave\", _this.onPointerCancel);\n\n      _this._domElement.addEventListener(\"touchmove\", _this.onTouchMove);\n\n      _this._domElement.addEventListener(\"touchstart\", _this.onTouchStart);\n\n      _this._domElement.addEventListener(\"touchend\", _this.onTouchEnd);\n    });\n\n    __publicField(_assertThisInitialized(_this), \"deactivate\", function () {\n      _this._domElement.removeEventListener(\"pointermove\", _this.onPointerMove);\n\n      _this._domElement.removeEventListener(\"pointerdown\", _this.onPointerDown);\n\n      _this._domElement.removeEventListener(\"pointerup\", _this.onPointerCancel);\n\n      _this._domElement.removeEventListener(\"pointerleave\", _this.onPointerCancel);\n\n      _this._domElement.removeEventListener(\"touchmove\", _this.onTouchMove);\n\n      _this._domElement.removeEventListener(\"touchstart\", _this.onTouchStart);\n\n      _this._domElement.removeEventListener(\"touchend\", _this.onTouchEnd);\n\n      _this._domElement.style.cursor = \"\";\n    }); // TODO: confirm if this can be removed?\n\n\n    __publicField(_assertThisInitialized(_this), \"dispose\", function () {\n      return _this.deactivate();\n    });\n\n    __publicField(_assertThisInitialized(_this), \"getObjects\", function () {\n      return _this._objects;\n    });\n\n    __publicField(_assertThisInitialized(_this), \"getRaycaster\", function () {\n      return _this._raycaster;\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onMouseMove\", function (event) {\n      var rect = _this._domElement.getBoundingClientRect();\n\n      _this._mouse.x = (event.clientX - rect.left) / rect.width * 2 - 1;\n      _this._mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n\n      _this._raycaster.setFromCamera(_this._mouse, _this._camera);\n\n      if (_this._selected && _this.enabled) {\n        if (_this._raycaster.ray.intersectPlane(_this._plane, _this._intersection)) {\n          _this._selected.position.copy(_this._intersection.sub(_this._offset).applyMatrix4(_this._inverseMatrix));\n        }\n\n        _this.dispatchEvent({\n          type: \"drag\",\n          object: _this._selected\n        });\n\n        return;\n      }\n\n      _this._intersections.length = 0;\n\n      _this._raycaster.setFromCamera(_this._mouse, _this._camera);\n\n      _this._raycaster.intersectObjects(_this._objects, true, _this._intersections);\n\n      if (_this._intersections.length > 0) {\n        var object = _this._intersections[0].object;\n\n        _this._plane.setFromNormalAndCoplanarPoint(_this._camera.getWorldDirection(_this._plane.normal), _this._worldPosition.setFromMatrixPosition(object.matrixWorld));\n\n        if (_this._hovered !== object) {\n          _this.dispatchEvent({\n            type: \"hoveron\",\n            object: object\n          });\n\n          _this._domElement.style.cursor = \"pointer\";\n          _this._hovered = object;\n        }\n      } else {\n        if (_this._hovered !== null) {\n          _this.dispatchEvent({\n            type: \"hoveroff\",\n            object: _this._hovered\n          });\n\n          _this._domElement.style.cursor = \"auto\";\n          _this._hovered = null;\n        }\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onMouseDown\", function () {\n      _this._intersections.length = 0;\n\n      _this._raycaster.setFromCamera(_this._mouse, _this._camera);\n\n      _this._raycaster.intersectObjects(_this._objects, true, _this._intersections);\n\n      if (_this._intersections.length > 0) {\n        _this._selected = _this.transformGroup === true ? _this._objects[0] : _this._intersections[0].object;\n\n        if (_this._raycaster.ray.intersectPlane(_this._plane, _this._intersection) && _this._selected.parent) {\n          _this._inverseMatrix.copy(_this._selected.parent.matrixWorld).invert();\n\n          _this._offset.copy(_this._intersection).sub(_this._worldPosition.setFromMatrixPosition(_this._selected.matrixWorld));\n        }\n\n        _this._domElement.style.cursor = \"move\";\n\n        _this.dispatchEvent({\n          type: \"dragstart\",\n          object: _this._selected\n        });\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onMouseCancel\", function () {\n      if (_this._selected) {\n        _this.dispatchEvent({\n          type: \"dragend\",\n          object: _this._selected\n        });\n\n        _this._selected = null;\n      }\n\n      _this._domElement.style.cursor = _this._hovered ? \"pointer\" : \"auto\";\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onPointerMove\", function (event) {\n      switch (event.pointerType) {\n        case \"mouse\":\n        case \"pen\":\n          _this.onMouseMove(event);\n\n          break;\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onPointerDown\", function (event) {\n      switch (event.pointerType) {\n        case \"mouse\":\n        case \"pen\":\n          _this.onMouseDown();\n\n          break;\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onPointerCancel\", function (event) {\n      switch (event.pointerType) {\n        case \"mouse\":\n        case \"pen\":\n          _this.onMouseCancel();\n\n          break;\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onTouchMove\", function (event) {\n      event.preventDefault();\n      var newEvent = event.changedTouches[0];\n\n      var rect = _this._domElement.getBoundingClientRect();\n\n      _this._mouse.x = (newEvent.clientX - rect.left) / rect.width * 2 - 1;\n      _this._mouse.y = -((newEvent.clientY - rect.top) / rect.height) * 2 + 1;\n\n      _this._raycaster.setFromCamera(_this._mouse, _this._camera);\n\n      if (_this._selected && _this.enabled) {\n        if (_this._raycaster.ray.intersectPlane(_this._plane, _this._intersection)) {\n          _this._selected.position.copy(_this._intersection.sub(_this._offset).applyMatrix4(_this._inverseMatrix));\n        }\n\n        _this.dispatchEvent({\n          type: \"drag\",\n          object: _this._selected\n        });\n\n        return;\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onTouchStart\", function (event) {\n      event.preventDefault();\n      var newEvent = event.changedTouches[0];\n\n      var rect = _this._domElement.getBoundingClientRect();\n\n      _this._mouse.x = (newEvent.clientX - rect.left) / rect.width * 2 - 1;\n      _this._mouse.y = -((newEvent.clientY - rect.top) / rect.height) * 2 + 1;\n      _this._intersections.length = 0;\n\n      _this._raycaster.setFromCamera(_this._mouse, _this._camera);\n\n      _this._raycaster.intersectObjects(_this._objects, true, _this._intersections);\n\n      if (_this._intersections.length > 0) {\n        _this._selected = _this.transformGroup === true ? _this._objects[0] : _this._intersections[0].object;\n\n        _this._plane.setFromNormalAndCoplanarPoint(_this._camera.getWorldDirection(_this._plane.normal), _this._worldPosition.setFromMatrixPosition(_this._selected.matrixWorld));\n\n        if (_this._raycaster.ray.intersectPlane(_this._plane, _this._intersection) && _this._selected.parent) {\n          _this._inverseMatrix.copy(_this._selected.parent.matrixWorld).invert();\n\n          _this._offset.copy(_this._intersection).sub(_this._worldPosition.setFromMatrixPosition(_this._selected.matrixWorld));\n        }\n\n        _this._domElement.style.cursor = \"move\";\n\n        _this.dispatchEvent({\n          type: \"dragstart\",\n          object: _this._selected\n        });\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onTouchEnd\", function (event) {\n      event.preventDefault();\n\n      if (_this._selected) {\n        _this.dispatchEvent({\n          type: \"dragend\",\n          object: _this._selected\n        });\n\n        _this._selected = null;\n      }\n\n      _this._domElement.style.cursor = \"auto\";\n    });\n\n    _this._objects = _objects;\n    _this._camera = _camera;\n    _this._domElement = _domElement;\n\n    _this.activate();\n\n    return _this;\n  }\n\n  return DragControls;\n}(EventDispatcher);\n\nexport { DragControls };","map":{"version":3,"sources":["/Users/theodaguier/_workdir/dev/pro/e-do/E-Do-Studio/node_modules/three-stdlib/controls/DragControls.js"],"names":["__defProp","Object","defineProperty","__defNormalProp","obj","key","value","enumerable","configurable","writable","__publicField","EventDispatcher","Plane","Raycaster","Vector2","Vector3","Matrix4","DragControls","_objects","_camera","_domElement","addEventListener","onPointerMove","onPointerDown","onPointerCancel","onTouchMove","onTouchStart","onTouchEnd","removeEventListener","style","cursor","deactivate","_raycaster","event","rect","getBoundingClientRect","_mouse","x","clientX","left","width","y","clientY","top","height","setFromCamera","_selected","enabled","ray","intersectPlane","_plane","_intersection","position","copy","sub","_offset","applyMatrix4","_inverseMatrix","dispatchEvent","type","object","_intersections","length","intersectObjects","setFromNormalAndCoplanarPoint","getWorldDirection","normal","_worldPosition","setFromMatrixPosition","matrixWorld","_hovered","transformGroup","parent","invert","pointerType","onMouseMove","onMouseDown","onMouseCancel","preventDefault","newEvent","changedTouches","activate"],"mappings":"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","sourcesContent":["var __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nimport { EventDispatcher, Plane, Raycaster, Vector2, Vector3, Matrix4 } from \"three\";\nclass DragControls extends EventDispatcher {\n  constructor(_objects, _camera, _domElement) {\n    super();\n    __publicField(this, \"enabled\", true);\n    __publicField(this, \"transformGroup\", false);\n    __publicField(this, \"_objects\");\n    __publicField(this, \"_camera\");\n    __publicField(this, \"_domElement\");\n    __publicField(this, \"_plane\", new Plane());\n    __publicField(this, \"_raycaster\", new Raycaster());\n    __publicField(this, \"_mouse\", new Vector2());\n    __publicField(this, \"_offset\", new Vector3());\n    __publicField(this, \"_intersection\", new Vector3());\n    __publicField(this, \"_worldPosition\", new Vector3());\n    __publicField(this, \"_inverseMatrix\", new Matrix4());\n    __publicField(this, \"_intersections\", []);\n    __publicField(this, \"_selected\", null);\n    __publicField(this, \"_hovered\", null);\n    __publicField(this, \"activate\", () => {\n      this._domElement.addEventListener(\"pointermove\", this.onPointerMove);\n      this._domElement.addEventListener(\"pointerdown\", this.onPointerDown);\n      this._domElement.addEventListener(\"pointerup\", this.onPointerCancel);\n      this._domElement.addEventListener(\"pointerleave\", this.onPointerCancel);\n      this._domElement.addEventListener(\"touchmove\", this.onTouchMove);\n      this._domElement.addEventListener(\"touchstart\", this.onTouchStart);\n      this._domElement.addEventListener(\"touchend\", this.onTouchEnd);\n    });\n    __publicField(this, \"deactivate\", () => {\n      this._domElement.removeEventListener(\"pointermove\", this.onPointerMove);\n      this._domElement.removeEventListener(\"pointerdown\", this.onPointerDown);\n      this._domElement.removeEventListener(\"pointerup\", this.onPointerCancel);\n      this._domElement.removeEventListener(\"pointerleave\", this.onPointerCancel);\n      this._domElement.removeEventListener(\"touchmove\", this.onTouchMove);\n      this._domElement.removeEventListener(\"touchstart\", this.onTouchStart);\n      this._domElement.removeEventListener(\"touchend\", this.onTouchEnd);\n      this._domElement.style.cursor = \"\";\n    });\n    // TODO: confirm if this can be removed?\n    __publicField(this, \"dispose\", () => this.deactivate());\n    __publicField(this, \"getObjects\", () => this._objects);\n    __publicField(this, \"getRaycaster\", () => this._raycaster);\n    __publicField(this, \"onMouseMove\", (event) => {\n      const rect = this._domElement.getBoundingClientRect();\n      this._mouse.x = (event.clientX - rect.left) / rect.width * 2 - 1;\n      this._mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n      this._raycaster.setFromCamera(this._mouse, this._camera);\n      if (this._selected && this.enabled) {\n        if (this._raycaster.ray.intersectPlane(this._plane, this._intersection)) {\n          this._selected.position.copy(this._intersection.sub(this._offset).applyMatrix4(this._inverseMatrix));\n        }\n        this.dispatchEvent({ type: \"drag\", object: this._selected });\n        return;\n      }\n      this._intersections.length = 0;\n      this._raycaster.setFromCamera(this._mouse, this._camera);\n      this._raycaster.intersectObjects(this._objects, true, this._intersections);\n      if (this._intersections.length > 0) {\n        const object = this._intersections[0].object;\n        this._plane.setFromNormalAndCoplanarPoint(\n          this._camera.getWorldDirection(this._plane.normal),\n          this._worldPosition.setFromMatrixPosition(object.matrixWorld)\n        );\n        if (this._hovered !== object) {\n          this.dispatchEvent({ type: \"hoveron\", object });\n          this._domElement.style.cursor = \"pointer\";\n          this._hovered = object;\n        }\n      } else {\n        if (this._hovered !== null) {\n          this.dispatchEvent({ type: \"hoveroff\", object: this._hovered });\n          this._domElement.style.cursor = \"auto\";\n          this._hovered = null;\n        }\n      }\n    });\n    __publicField(this, \"onMouseDown\", () => {\n      this._intersections.length = 0;\n      this._raycaster.setFromCamera(this._mouse, this._camera);\n      this._raycaster.intersectObjects(this._objects, true, this._intersections);\n      if (this._intersections.length > 0) {\n        this._selected = this.transformGroup === true ? this._objects[0] : this._intersections[0].object;\n        if (this._raycaster.ray.intersectPlane(this._plane, this._intersection) && this._selected.parent) {\n          this._inverseMatrix.copy(this._selected.parent.matrixWorld).invert();\n          this._offset.copy(this._intersection).sub(this._worldPosition.setFromMatrixPosition(this._selected.matrixWorld));\n        }\n        this._domElement.style.cursor = \"move\";\n        this.dispatchEvent({ type: \"dragstart\", object: this._selected });\n      }\n    });\n    __publicField(this, \"onMouseCancel\", () => {\n      if (this._selected) {\n        this.dispatchEvent({ type: \"dragend\", object: this._selected });\n        this._selected = null;\n      }\n      this._domElement.style.cursor = this._hovered ? \"pointer\" : \"auto\";\n    });\n    __publicField(this, \"onPointerMove\", (event) => {\n      switch (event.pointerType) {\n        case \"mouse\":\n        case \"pen\":\n          this.onMouseMove(event);\n          break;\n      }\n    });\n    __publicField(this, \"onPointerDown\", (event) => {\n      switch (event.pointerType) {\n        case \"mouse\":\n        case \"pen\":\n          this.onMouseDown();\n          break;\n      }\n    });\n    __publicField(this, \"onPointerCancel\", (event) => {\n      switch (event.pointerType) {\n        case \"mouse\":\n        case \"pen\":\n          this.onMouseCancel();\n          break;\n      }\n    });\n    __publicField(this, \"onTouchMove\", (event) => {\n      event.preventDefault();\n      const newEvent = event.changedTouches[0];\n      const rect = this._domElement.getBoundingClientRect();\n      this._mouse.x = (newEvent.clientX - rect.left) / rect.width * 2 - 1;\n      this._mouse.y = -((newEvent.clientY - rect.top) / rect.height) * 2 + 1;\n      this._raycaster.setFromCamera(this._mouse, this._camera);\n      if (this._selected && this.enabled) {\n        if (this._raycaster.ray.intersectPlane(this._plane, this._intersection)) {\n          this._selected.position.copy(this._intersection.sub(this._offset).applyMatrix4(this._inverseMatrix));\n        }\n        this.dispatchEvent({ type: \"drag\", object: this._selected });\n        return;\n      }\n    });\n    __publicField(this, \"onTouchStart\", (event) => {\n      event.preventDefault();\n      const newEvent = event.changedTouches[0];\n      const rect = this._domElement.getBoundingClientRect();\n      this._mouse.x = (newEvent.clientX - rect.left) / rect.width * 2 - 1;\n      this._mouse.y = -((newEvent.clientY - rect.top) / rect.height) * 2 + 1;\n      this._intersections.length = 0;\n      this._raycaster.setFromCamera(this._mouse, this._camera);\n      this._raycaster.intersectObjects(this._objects, true, this._intersections);\n      if (this._intersections.length > 0) {\n        this._selected = this.transformGroup === true ? this._objects[0] : this._intersections[0].object;\n        this._plane.setFromNormalAndCoplanarPoint(\n          this._camera.getWorldDirection(this._plane.normal),\n          this._worldPosition.setFromMatrixPosition(this._selected.matrixWorld)\n        );\n        if (this._raycaster.ray.intersectPlane(this._plane, this._intersection) && this._selected.parent) {\n          this._inverseMatrix.copy(this._selected.parent.matrixWorld).invert();\n          this._offset.copy(this._intersection).sub(this._worldPosition.setFromMatrixPosition(this._selected.matrixWorld));\n        }\n        this._domElement.style.cursor = \"move\";\n        this.dispatchEvent({ type: \"dragstart\", object: this._selected });\n      }\n    });\n    __publicField(this, \"onTouchEnd\", (event) => {\n      event.preventDefault();\n      if (this._selected) {\n        this.dispatchEvent({ type: \"dragend\", object: this._selected });\n        this._selected = null;\n      }\n      this._domElement.style.cursor = \"auto\";\n    });\n    this._objects = _objects;\n    this._camera = _camera;\n    this._domElement = _domElement;\n    this.activate();\n  }\n}\nexport {\n  DragControls\n};\n"]},"metadata":{},"sourceType":"module"}