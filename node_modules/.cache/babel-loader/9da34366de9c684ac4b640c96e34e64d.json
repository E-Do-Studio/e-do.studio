{"ast":null,"code":"import _classCallCheck from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _assertThisInitialized from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar __defProp = Object.defineProperty;\n\nvar __defNormalProp = function __defNormalProp(obj, key, value) {\n  return key in obj ? __defProp(obj, key, {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: value\n  }) : obj[key] = value;\n};\n\nvar __publicField = function __publicField(obj, key, value) {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n\n  return value;\n};\n\nimport { Vector3, EventDispatcher, Spherical, MathUtils } from \"three\";\nvar targetPosition = /* @__PURE__ */new Vector3();\n\nvar FirstPersonControls = /*#__PURE__*/function (_EventDispatcher) {\n  _inherits(FirstPersonControls, _EventDispatcher);\n\n  var _super = _createSuper(FirstPersonControls);\n\n  function FirstPersonControls(object, domElement) {\n    var _this;\n\n    _classCallCheck(this, FirstPersonControls);\n\n    _this = _super.call(this);\n\n    __publicField(_assertThisInitialized(_this), \"object\");\n\n    __publicField(_assertThisInitialized(_this), \"domElement\");\n\n    __publicField(_assertThisInitialized(_this), \"enabled\", true);\n\n    __publicField(_assertThisInitialized(_this), \"movementSpeed\", 1);\n\n    __publicField(_assertThisInitialized(_this), \"lookSpeed\", 5e-3);\n\n    __publicField(_assertThisInitialized(_this), \"lookVertical\", true);\n\n    __publicField(_assertThisInitialized(_this), \"autoForward\", false);\n\n    __publicField(_assertThisInitialized(_this), \"activeLook\", true);\n\n    __publicField(_assertThisInitialized(_this), \"heightSpeed\", false);\n\n    __publicField(_assertThisInitialized(_this), \"heightCoef\", 1);\n\n    __publicField(_assertThisInitialized(_this), \"heightMin\", 0);\n\n    __publicField(_assertThisInitialized(_this), \"heightMax\", 1);\n\n    __publicField(_assertThisInitialized(_this), \"constrainVertical\", false);\n\n    __publicField(_assertThisInitialized(_this), \"verticalMin\", 0);\n\n    __publicField(_assertThisInitialized(_this), \"verticalMax\", Math.PI);\n\n    __publicField(_assertThisInitialized(_this), \"mouseDragOn\", false); // internals\n\n\n    __publicField(_assertThisInitialized(_this), \"autoSpeedFactor\", 0);\n\n    __publicField(_assertThisInitialized(_this), \"mouseX\", 0);\n\n    __publicField(_assertThisInitialized(_this), \"mouseY\", 0);\n\n    __publicField(_assertThisInitialized(_this), \"moveForward\", false);\n\n    __publicField(_assertThisInitialized(_this), \"moveBackward\", false);\n\n    __publicField(_assertThisInitialized(_this), \"moveLeft\", false);\n\n    __publicField(_assertThisInitialized(_this), \"moveRight\", false);\n\n    __publicField(_assertThisInitialized(_this), \"moveUp\", false);\n\n    __publicField(_assertThisInitialized(_this), \"moveDown\", false);\n\n    __publicField(_assertThisInitialized(_this), \"viewHalfX\", 0);\n\n    __publicField(_assertThisInitialized(_this), \"viewHalfY\", 0);\n\n    __publicField(_assertThisInitialized(_this), \"lat\", 0);\n\n    __publicField(_assertThisInitialized(_this), \"lon\", 0);\n\n    __publicField(_assertThisInitialized(_this), \"lookDirection\", new Vector3());\n\n    __publicField(_assertThisInitialized(_this), \"spherical\", new Spherical());\n\n    __publicField(_assertThisInitialized(_this), \"target\", new Vector3());\n\n    __publicField(_assertThisInitialized(_this), \"connect\", function (domElement) {\n      domElement.setAttribute(\"tabindex\", \"-1\");\n      domElement.style.touchAction = \"none\";\n      domElement.addEventListener(\"contextmenu\", _this.contextmenu);\n      domElement.addEventListener(\"mousemove\", _this.onMouseMove);\n      domElement.addEventListener(\"mousedown\", _this.onMouseDown);\n      domElement.addEventListener(\"mouseup\", _this.onMouseUp);\n      _this.domElement = domElement;\n      window.addEventListener(\"keydown\", _this.onKeyDown);\n      window.addEventListener(\"keyup\", _this.onKeyUp);\n\n      _this.handleResize();\n    });\n\n    __publicField(_assertThisInitialized(_this), \"dispose\", function () {\n      var _a, _b, _c, _d;\n\n      (_a = _this.domElement) == null ? void 0 : _a.removeEventListener(\"contextmenu\", _this.contextmenu);\n      (_b = _this.domElement) == null ? void 0 : _b.removeEventListener(\"mousedown\", _this.onMouseDown);\n      (_c = _this.domElement) == null ? void 0 : _c.removeEventListener(\"mousemove\", _this.onMouseMove);\n      (_d = _this.domElement) == null ? void 0 : _d.removeEventListener(\"mouseup\", _this.onMouseUp);\n      window.removeEventListener(\"keydown\", _this.onKeyDown);\n      window.removeEventListener(\"keyup\", _this.onKeyUp);\n    });\n\n    __publicField(_assertThisInitialized(_this), \"handleResize\", function () {\n      if (_this.domElement) {\n        _this.viewHalfX = _this.domElement.offsetWidth / 2;\n        _this.viewHalfY = _this.domElement.offsetHeight / 2;\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onMouseDown\", function (event) {\n      var _a;\n\n      (_a = _this.domElement) == null ? void 0 : _a.focus();\n\n      if (_this.activeLook) {\n        switch (event.button) {\n          case 0:\n            _this.moveForward = true;\n            break;\n\n          case 2:\n            _this.moveBackward = true;\n            break;\n        }\n      }\n\n      _this.mouseDragOn = true;\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onMouseUp\", function (event) {\n      if (_this.activeLook) {\n        switch (event.button) {\n          case 0:\n            _this.moveForward = false;\n            break;\n\n          case 2:\n            _this.moveBackward = false;\n            break;\n        }\n      }\n\n      _this.mouseDragOn = false;\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onMouseMove\", function (event) {\n      if (_this.domElement) {\n        _this.mouseX = event.pageX - _this.domElement.offsetLeft - _this.viewHalfX;\n        _this.mouseY = event.pageY - _this.domElement.offsetTop - _this.viewHalfY;\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onKeyDown\", function (event) {\n      switch (event.code) {\n        case \"ArrowUp\":\n        case \"KeyW\":\n          _this.moveForward = true;\n          break;\n\n        case \"ArrowLeft\":\n        case \"KeyA\":\n          _this.moveLeft = true;\n          break;\n\n        case \"ArrowDown\":\n        case \"KeyS\":\n          _this.moveBackward = true;\n          break;\n\n        case \"ArrowRight\":\n        case \"KeyD\":\n          _this.moveRight = true;\n          break;\n\n        case \"KeyR\":\n          _this.moveUp = true;\n          break;\n\n        case \"KeyF\":\n          _this.moveDown = true;\n          break;\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"onKeyUp\", function (event) {\n      switch (event.code) {\n        case \"ArrowUp\":\n        case \"KeyW\":\n          _this.moveForward = false;\n          break;\n\n        case \"ArrowLeft\":\n        case \"KeyA\":\n          _this.moveLeft = false;\n          break;\n\n        case \"ArrowDown\":\n        case \"KeyS\":\n          _this.moveBackward = false;\n          break;\n\n        case \"ArrowRight\":\n        case \"KeyD\":\n          _this.moveRight = false;\n          break;\n\n        case \"KeyR\":\n          _this.moveUp = false;\n          break;\n\n        case \"KeyF\":\n          _this.moveDown = false;\n          break;\n      }\n    });\n\n    __publicField(_assertThisInitialized(_this), \"lookAt\", function (x, y, z) {\n      if (x instanceof Vector3) {\n        _this.target.copy(x);\n      } else if (y && z) {\n        _this.target.set(x, y, z);\n      }\n\n      _this.object.lookAt(_this.target);\n\n      _this.setOrientation();\n\n      return _assertThisInitialized(_this);\n    });\n\n    __publicField(_assertThisInitialized(_this), \"update\", function (delta) {\n      if (!_this.enabled) return;\n\n      if (_this.heightSpeed) {\n        var y = MathUtils.clamp(_this.object.position.y, _this.heightMin, _this.heightMax);\n        var heightDelta = y - _this.heightMin;\n        _this.autoSpeedFactor = delta * (heightDelta * _this.heightCoef);\n      } else {\n        _this.autoSpeedFactor = 0;\n      }\n\n      var actualMoveSpeed = delta * _this.movementSpeed;\n\n      if (_this.moveForward || _this.autoForward && !_this.moveBackward) {\n        _this.object.translateZ(-(actualMoveSpeed + _this.autoSpeedFactor));\n      }\n\n      if (_this.moveBackward) _this.object.translateZ(actualMoveSpeed);\n      if (_this.moveLeft) _this.object.translateX(-actualMoveSpeed);\n      if (_this.moveRight) _this.object.translateX(actualMoveSpeed);\n      if (_this.moveUp) _this.object.translateY(actualMoveSpeed);\n      if (_this.moveDown) _this.object.translateY(-actualMoveSpeed);\n      var actualLookSpeed = delta * _this.lookSpeed;\n\n      if (!_this.activeLook) {\n        actualLookSpeed = 0;\n      }\n\n      var verticalLookRatio = 1;\n\n      if (_this.constrainVertical) {\n        verticalLookRatio = Math.PI / (_this.verticalMax - _this.verticalMin);\n      }\n\n      _this.lon -= _this.mouseX * actualLookSpeed;\n      if (_this.lookVertical) _this.lat -= _this.mouseY * actualLookSpeed * verticalLookRatio;\n      _this.lat = Math.max(-85, Math.min(85, _this.lat));\n      var phi = MathUtils.degToRad(90 - _this.lat);\n      var theta = MathUtils.degToRad(_this.lon);\n\n      if (_this.constrainVertical) {\n        phi = MathUtils.mapLinear(phi, 0, Math.PI, _this.verticalMin, _this.verticalMax);\n      }\n\n      var position = _this.object.position;\n      targetPosition.setFromSphericalCoords(1, phi, theta).add(position);\n\n      _this.object.lookAt(targetPosition);\n    });\n\n    __publicField(_assertThisInitialized(_this), \"contextmenu\", function (event) {\n      return event.preventDefault();\n    });\n\n    __publicField(_assertThisInitialized(_this), \"setOrientation\", function () {\n      _this.lookDirection.set(0, 0, -1).applyQuaternion(_this.object.quaternion);\n\n      _this.spherical.setFromVector3(_this.lookDirection);\n\n      _this.lat = 90 - MathUtils.radToDeg(_this.spherical.phi);\n      _this.lon = MathUtils.radToDeg(_this.spherical.theta);\n    });\n\n    _this.object = object;\n    _this.domElement = domElement;\n\n    _this.setOrientation();\n\n    if (domElement) _this.connect(domElement);\n    return _this;\n  }\n\n  return FirstPersonControls;\n}(EventDispatcher);\n\nexport { FirstPersonControls };","map":{"version":3,"sources":["/Users/theodaguier/Repositories/E-Do-Studio/node_modules/three-stdlib/controls/FirstPersonControls.js"],"names":["__defProp","Object","defineProperty","__defNormalProp","obj","key","value","enumerable","configurable","writable","__publicField","Vector3","EventDispatcher","Spherical","MathUtils","targetPosition","FirstPersonControls","object","domElement","Math","PI","setAttribute","style","touchAction","addEventListener","contextmenu","onMouseMove","onMouseDown","onMouseUp","window","onKeyDown","onKeyUp","handleResize","_a","_b","_c","_d","removeEventListener","viewHalfX","offsetWidth","viewHalfY","offsetHeight","event","focus","activeLook","button","moveForward","moveBackward","mouseDragOn","mouseX","pageX","offsetLeft","mouseY","pageY","offsetTop","code","moveLeft","moveRight","moveUp","moveDown","x","y","z","target","copy","set","lookAt","setOrientation","delta","enabled","heightSpeed","clamp","position","heightMin","heightMax","heightDelta","autoSpeedFactor","heightCoef","actualMoveSpeed","movementSpeed","autoForward","translateZ","translateX","translateY","actualLookSpeed","lookSpeed","verticalLookRatio","constrainVertical","verticalMax","verticalMin","lon","lookVertical","lat","max","min","phi","degToRad","theta","mapLinear","setFromSphericalCoords","add","preventDefault","lookDirection","applyQuaternion","quaternion","spherical","setFromVector3","radToDeg","connect"],"mappings":"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","sourcesContent":["var __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nimport { Vector3, EventDispatcher, Spherical, MathUtils } from \"three\";\nconst targetPosition = /* @__PURE__ */ new Vector3();\nclass FirstPersonControls extends EventDispatcher {\n  constructor(object, domElement) {\n    super();\n    __publicField(this, \"object\");\n    __publicField(this, \"domElement\");\n    __publicField(this, \"enabled\", true);\n    __publicField(this, \"movementSpeed\", 1);\n    __publicField(this, \"lookSpeed\", 5e-3);\n    __publicField(this, \"lookVertical\", true);\n    __publicField(this, \"autoForward\", false);\n    __publicField(this, \"activeLook\", true);\n    __publicField(this, \"heightSpeed\", false);\n    __publicField(this, \"heightCoef\", 1);\n    __publicField(this, \"heightMin\", 0);\n    __publicField(this, \"heightMax\", 1);\n    __publicField(this, \"constrainVertical\", false);\n    __publicField(this, \"verticalMin\", 0);\n    __publicField(this, \"verticalMax\", Math.PI);\n    __publicField(this, \"mouseDragOn\", false);\n    // internals\n    __publicField(this, \"autoSpeedFactor\", 0);\n    __publicField(this, \"mouseX\", 0);\n    __publicField(this, \"mouseY\", 0);\n    __publicField(this, \"moveForward\", false);\n    __publicField(this, \"moveBackward\", false);\n    __publicField(this, \"moveLeft\", false);\n    __publicField(this, \"moveRight\", false);\n    __publicField(this, \"moveUp\", false);\n    __publicField(this, \"moveDown\", false);\n    __publicField(this, \"viewHalfX\", 0);\n    __publicField(this, \"viewHalfY\", 0);\n    __publicField(this, \"lat\", 0);\n    __publicField(this, \"lon\", 0);\n    __publicField(this, \"lookDirection\", new Vector3());\n    __publicField(this, \"spherical\", new Spherical());\n    __publicField(this, \"target\", new Vector3());\n    __publicField(this, \"connect\", (domElement) => {\n      domElement.setAttribute(\"tabindex\", \"-1\");\n      domElement.style.touchAction = \"none\";\n      domElement.addEventListener(\"contextmenu\", this.contextmenu);\n      domElement.addEventListener(\"mousemove\", this.onMouseMove);\n      domElement.addEventListener(\"mousedown\", this.onMouseDown);\n      domElement.addEventListener(\"mouseup\", this.onMouseUp);\n      this.domElement = domElement;\n      window.addEventListener(\"keydown\", this.onKeyDown);\n      window.addEventListener(\"keyup\", this.onKeyUp);\n      this.handleResize();\n    });\n    __publicField(this, \"dispose\", () => {\n      var _a, _b, _c, _d;\n      (_a = this.domElement) == null ? void 0 : _a.removeEventListener(\"contextmenu\", this.contextmenu);\n      (_b = this.domElement) == null ? void 0 : _b.removeEventListener(\"mousedown\", this.onMouseDown);\n      (_c = this.domElement) == null ? void 0 : _c.removeEventListener(\"mousemove\", this.onMouseMove);\n      (_d = this.domElement) == null ? void 0 : _d.removeEventListener(\"mouseup\", this.onMouseUp);\n      window.removeEventListener(\"keydown\", this.onKeyDown);\n      window.removeEventListener(\"keyup\", this.onKeyUp);\n    });\n    __publicField(this, \"handleResize\", () => {\n      if (this.domElement) {\n        this.viewHalfX = this.domElement.offsetWidth / 2;\n        this.viewHalfY = this.domElement.offsetHeight / 2;\n      }\n    });\n    __publicField(this, \"onMouseDown\", (event) => {\n      var _a;\n      (_a = this.domElement) == null ? void 0 : _a.focus();\n      if (this.activeLook) {\n        switch (event.button) {\n          case 0:\n            this.moveForward = true;\n            break;\n          case 2:\n            this.moveBackward = true;\n            break;\n        }\n      }\n      this.mouseDragOn = true;\n    });\n    __publicField(this, \"onMouseUp\", (event) => {\n      if (this.activeLook) {\n        switch (event.button) {\n          case 0:\n            this.moveForward = false;\n            break;\n          case 2:\n            this.moveBackward = false;\n            break;\n        }\n      }\n      this.mouseDragOn = false;\n    });\n    __publicField(this, \"onMouseMove\", (event) => {\n      if (this.domElement) {\n        this.mouseX = event.pageX - this.domElement.offsetLeft - this.viewHalfX;\n        this.mouseY = event.pageY - this.domElement.offsetTop - this.viewHalfY;\n      }\n    });\n    __publicField(this, \"onKeyDown\", (event) => {\n      switch (event.code) {\n        case \"ArrowUp\":\n        case \"KeyW\":\n          this.moveForward = true;\n          break;\n        case \"ArrowLeft\":\n        case \"KeyA\":\n          this.moveLeft = true;\n          break;\n        case \"ArrowDown\":\n        case \"KeyS\":\n          this.moveBackward = true;\n          break;\n        case \"ArrowRight\":\n        case \"KeyD\":\n          this.moveRight = true;\n          break;\n        case \"KeyR\":\n          this.moveUp = true;\n          break;\n        case \"KeyF\":\n          this.moveDown = true;\n          break;\n      }\n    });\n    __publicField(this, \"onKeyUp\", (event) => {\n      switch (event.code) {\n        case \"ArrowUp\":\n        case \"KeyW\":\n          this.moveForward = false;\n          break;\n        case \"ArrowLeft\":\n        case \"KeyA\":\n          this.moveLeft = false;\n          break;\n        case \"ArrowDown\":\n        case \"KeyS\":\n          this.moveBackward = false;\n          break;\n        case \"ArrowRight\":\n        case \"KeyD\":\n          this.moveRight = false;\n          break;\n        case \"KeyR\":\n          this.moveUp = false;\n          break;\n        case \"KeyF\":\n          this.moveDown = false;\n          break;\n      }\n    });\n    __publicField(this, \"lookAt\", (x, y, z) => {\n      if (x instanceof Vector3) {\n        this.target.copy(x);\n      } else if (y && z) {\n        this.target.set(x, y, z);\n      }\n      this.object.lookAt(this.target);\n      this.setOrientation();\n      return this;\n    });\n    __publicField(this, \"update\", (delta) => {\n      if (!this.enabled)\n        return;\n      if (this.heightSpeed) {\n        const y = MathUtils.clamp(this.object.position.y, this.heightMin, this.heightMax);\n        const heightDelta = y - this.heightMin;\n        this.autoSpeedFactor = delta * (heightDelta * this.heightCoef);\n      } else {\n        this.autoSpeedFactor = 0;\n      }\n      const actualMoveSpeed = delta * this.movementSpeed;\n      if (this.moveForward || this.autoForward && !this.moveBackward) {\n        this.object.translateZ(-(actualMoveSpeed + this.autoSpeedFactor));\n      }\n      if (this.moveBackward)\n        this.object.translateZ(actualMoveSpeed);\n      if (this.moveLeft)\n        this.object.translateX(-actualMoveSpeed);\n      if (this.moveRight)\n        this.object.translateX(actualMoveSpeed);\n      if (this.moveUp)\n        this.object.translateY(actualMoveSpeed);\n      if (this.moveDown)\n        this.object.translateY(-actualMoveSpeed);\n      let actualLookSpeed = delta * this.lookSpeed;\n      if (!this.activeLook) {\n        actualLookSpeed = 0;\n      }\n      let verticalLookRatio = 1;\n      if (this.constrainVertical) {\n        verticalLookRatio = Math.PI / (this.verticalMax - this.verticalMin);\n      }\n      this.lon -= this.mouseX * actualLookSpeed;\n      if (this.lookVertical)\n        this.lat -= this.mouseY * actualLookSpeed * verticalLookRatio;\n      this.lat = Math.max(-85, Math.min(85, this.lat));\n      let phi = MathUtils.degToRad(90 - this.lat);\n      const theta = MathUtils.degToRad(this.lon);\n      if (this.constrainVertical) {\n        phi = MathUtils.mapLinear(phi, 0, Math.PI, this.verticalMin, this.verticalMax);\n      }\n      const position = this.object.position;\n      targetPosition.setFromSphericalCoords(1, phi, theta).add(position);\n      this.object.lookAt(targetPosition);\n    });\n    __publicField(this, \"contextmenu\", (event) => event.preventDefault());\n    __publicField(this, \"setOrientation\", () => {\n      this.lookDirection.set(0, 0, -1).applyQuaternion(this.object.quaternion);\n      this.spherical.setFromVector3(this.lookDirection);\n      this.lat = 90 - MathUtils.radToDeg(this.spherical.phi);\n      this.lon = MathUtils.radToDeg(this.spherical.theta);\n    });\n    this.object = object;\n    this.domElement = domElement;\n    this.setOrientation();\n    if (domElement)\n      this.connect(domElement);\n  }\n}\nexport {\n  FirstPersonControls\n};\n"]},"metadata":{},"sourceType":"module"}