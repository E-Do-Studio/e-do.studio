{"ast":null,"code":"var __defProp = Object.defineProperty;\n\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, {\n  enumerable: true,\n  configurable: true,\n  writable: true,\n  value\n}) : obj[key] = value;\n\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n\n  return value;\n};\n\nimport { EventDispatcher, Quaternion, Vector3 } from \"three\";\n\nfunction contextmenu(event) {\n  event.preventDefault();\n}\n\nclass FlyControls extends EventDispatcher {\n  constructor(object, domElement) {\n    super();\n\n    __publicField(this, \"object\");\n\n    __publicField(this, \"domElement\", null);\n\n    __publicField(this, \"movementSpeed\", 1);\n\n    __publicField(this, \"rollSpeed\", 5e-3);\n\n    __publicField(this, \"dragToLook\", false);\n\n    __publicField(this, \"autoForward\", false);\n\n    __publicField(this, \"changeEvent\", {\n      type: \"change\"\n    });\n\n    __publicField(this, \"EPS\", 1e-6);\n\n    __publicField(this, \"tmpQuaternion\", new Quaternion());\n\n    __publicField(this, \"mouseStatus\", 0);\n\n    __publicField(this, \"movementSpeedMultiplier\", 1);\n\n    __publicField(this, \"moveState\", {\n      up: 0,\n      down: 0,\n      left: 0,\n      right: 0,\n      forward: 0,\n      back: 0,\n      pitchUp: 0,\n      pitchDown: 0,\n      yawLeft: 0,\n      yawRight: 0,\n      rollLeft: 0,\n      rollRight: 0\n    });\n\n    __publicField(this, \"moveVector\", new Vector3(0, 0, 0));\n\n    __publicField(this, \"rotationVector\", new Vector3(0, 0, 0));\n\n    __publicField(this, \"keydown\", event => {\n      if (event.altKey) {\n        return;\n      }\n\n      switch (event.code) {\n        case \"ShiftLeft\":\n        case \"ShiftRight\":\n          this.movementSpeedMultiplier = 0.1;\n          break;\n\n        case \"KeyW\":\n          this.moveState.forward = 1;\n          break;\n\n        case \"KeyS\":\n          this.moveState.back = 1;\n          break;\n\n        case \"KeyA\":\n          this.moveState.left = 1;\n          break;\n\n        case \"KeyD\":\n          this.moveState.right = 1;\n          break;\n\n        case \"KeyR\":\n          this.moveState.up = 1;\n          break;\n\n        case \"KeyF\":\n          this.moveState.down = 1;\n          break;\n\n        case \"ArrowUp\":\n          this.moveState.pitchUp = 1;\n          break;\n\n        case \"ArrowDown\":\n          this.moveState.pitchDown = 1;\n          break;\n\n        case \"ArrowLeft\":\n          this.moveState.yawLeft = 1;\n          break;\n\n        case \"ArrowRight\":\n          this.moveState.yawRight = 1;\n          break;\n\n        case \"KeyQ\":\n          this.moveState.rollLeft = 1;\n          break;\n\n        case \"KeyE\":\n          this.moveState.rollRight = 1;\n          break;\n      }\n\n      this.updateMovementVector();\n      this.updateRotationVector();\n    });\n\n    __publicField(this, \"keyup\", event => {\n      switch (event.code) {\n        case \"ShiftLeft\":\n        case \"ShiftRight\":\n          this.movementSpeedMultiplier = 1;\n          break;\n\n        case \"KeyW\":\n          this.moveState.forward = 0;\n          break;\n\n        case \"KeyS\":\n          this.moveState.back = 0;\n          break;\n\n        case \"KeyA\":\n          this.moveState.left = 0;\n          break;\n\n        case \"KeyD\":\n          this.moveState.right = 0;\n          break;\n\n        case \"KeyR\":\n          this.moveState.up = 0;\n          break;\n\n        case \"KeyF\":\n          this.moveState.down = 0;\n          break;\n\n        case \"ArrowUp\":\n          this.moveState.pitchUp = 0;\n          break;\n\n        case \"ArrowDown\":\n          this.moveState.pitchDown = 0;\n          break;\n\n        case \"ArrowLeft\":\n          this.moveState.yawLeft = 0;\n          break;\n\n        case \"ArrowRight\":\n          this.moveState.yawRight = 0;\n          break;\n\n        case \"KeyQ\":\n          this.moveState.rollLeft = 0;\n          break;\n\n        case \"KeyE\":\n          this.moveState.rollRight = 0;\n          break;\n      }\n\n      this.updateMovementVector();\n      this.updateRotationVector();\n    });\n\n    __publicField(this, \"pointerdown\", event => {\n      if (this.dragToLook) {\n        this.mouseStatus++;\n      } else {\n        switch (event.button) {\n          case 0:\n            this.moveState.forward = 1;\n            break;\n\n          case 2:\n            this.moveState.back = 1;\n            break;\n        }\n\n        this.updateMovementVector();\n      }\n    });\n\n    __publicField(this, \"pointermove\", event => {\n      if (!this.dragToLook || this.mouseStatus > 0) {\n        const container = this.getContainerDimensions();\n        const halfWidth = container.size[0] / 2;\n        const halfHeight = container.size[1] / 2;\n        this.moveState.yawLeft = -(event.pageX - container.offset[0] - halfWidth) / halfWidth;\n        this.moveState.pitchDown = (event.pageY - container.offset[1] - halfHeight) / halfHeight;\n        this.updateRotationVector();\n      }\n    });\n\n    __publicField(this, \"pointerup\", event => {\n      if (this.dragToLook) {\n        this.mouseStatus--;\n        this.moveState.yawLeft = this.moveState.pitchDown = 0;\n      } else {\n        switch (event.button) {\n          case 0:\n            this.moveState.forward = 0;\n            break;\n\n          case 2:\n            this.moveState.back = 0;\n            break;\n        }\n\n        this.updateMovementVector();\n      }\n\n      this.updateRotationVector();\n    });\n\n    __publicField(this, \"lastQuaternion\", new Quaternion());\n\n    __publicField(this, \"lastPosition\", new Vector3());\n\n    __publicField(this, \"update\", delta => {\n      const moveMult = delta * this.movementSpeed;\n      const rotMult = delta * this.rollSpeed;\n      this.object.translateX(this.moveVector.x * moveMult);\n      this.object.translateY(this.moveVector.y * moveMult);\n      this.object.translateZ(this.moveVector.z * moveMult);\n      this.tmpQuaternion.set(this.rotationVector.x * rotMult, this.rotationVector.y * rotMult, this.rotationVector.z * rotMult, 1).normalize();\n      this.object.quaternion.multiply(this.tmpQuaternion);\n\n      if (this.lastPosition.distanceToSquared(this.object.position) > this.EPS || 8 * (1 - this.lastQuaternion.dot(this.object.quaternion)) > this.EPS) {\n        this.dispatchEvent(this.changeEvent);\n        this.lastQuaternion.copy(this.object.quaternion);\n        this.lastPosition.copy(this.object.position);\n      }\n    });\n\n    __publicField(this, \"updateMovementVector\", () => {\n      const forward = this.moveState.forward || this.autoForward && !this.moveState.back ? 1 : 0;\n      this.moveVector.x = -this.moveState.left + this.moveState.right;\n      this.moveVector.y = -this.moveState.down + this.moveState.up;\n      this.moveVector.z = -forward + this.moveState.back;\n    });\n\n    __publicField(this, \"updateRotationVector\", () => {\n      this.rotationVector.x = -this.moveState.pitchDown + this.moveState.pitchUp;\n      this.rotationVector.y = -this.moveState.yawRight + this.moveState.yawLeft;\n      this.rotationVector.z = -this.moveState.rollRight + this.moveState.rollLeft;\n    });\n\n    __publicField(this, \"getContainerDimensions\", () => {\n      if (this.domElement != document && !(this.domElement instanceof Document)) {\n        return {\n          size: [this.domElement.offsetWidth, this.domElement.offsetHeight],\n          offset: [this.domElement.offsetLeft, this.domElement.offsetTop]\n        };\n      } else {\n        return {\n          size: [window.innerWidth, window.innerHeight],\n          offset: [0, 0]\n        };\n      }\n    }); // https://github.com/mrdoob/three.js/issues/20575\n\n\n    __publicField(this, \"connect\", domElement => {\n      this.domElement = domElement;\n\n      if (domElement && !(domElement instanceof Document)) {\n        domElement.setAttribute(\"tabindex\", -1);\n      }\n\n      this.domElement.addEventListener(\"contextmenu\", contextmenu);\n      this.domElement.addEventListener(\"pointermove\", this.pointermove);\n      this.domElement.addEventListener(\"pointerdown\", this.pointerdown);\n      this.domElement.addEventListener(\"pointerup\", this.pointerup);\n      window.addEventListener(\"keydown\", this.keydown);\n      window.addEventListener(\"keyup\", this.keyup);\n    });\n\n    __publicField(this, \"dispose\", () => {\n      this.domElement.removeEventListener(\"contextmenu\", contextmenu);\n      this.domElement.removeEventListener(\"pointermove\", this.pointermove);\n      this.domElement.removeEventListener(\"pointerdown\", this.pointerdown);\n      this.domElement.removeEventListener(\"pointerup\", this.pointerup);\n      window.removeEventListener(\"keydown\", this.keydown);\n      window.removeEventListener(\"keyup\", this.keyup);\n    });\n\n    this.object = object;\n    if (domElement !== void 0) this.connect(domElement);\n    this.updateMovementVector();\n    this.updateRotationVector();\n  }\n\n}\n\nexport { FlyControls };","map":{"version":3,"sources":["/Users/theodaguier/_workdir/dev/pro/e-do/E-Do-Studio/node_modules/three-stdlib/controls/FlyControls.js"],"names":["__defProp","Object","defineProperty","__defNormalProp","obj","key","value","enumerable","configurable","writable","__publicField","EventDispatcher","Quaternion","Vector3","contextmenu","event","preventDefault","FlyControls","constructor","object","domElement","type","up","down","left","right","forward","back","pitchUp","pitchDown","yawLeft","yawRight","rollLeft","rollRight","altKey","code","movementSpeedMultiplier","moveState","updateMovementVector","updateRotationVector","dragToLook","mouseStatus","button","container","getContainerDimensions","halfWidth","size","halfHeight","pageX","offset","pageY","delta","moveMult","movementSpeed","rotMult","rollSpeed","translateX","moveVector","x","translateY","y","translateZ","z","tmpQuaternion","set","rotationVector","normalize","quaternion","multiply","lastPosition","distanceToSquared","position","EPS","lastQuaternion","dot","dispatchEvent","changeEvent","copy","autoForward","document","Document","offsetWidth","offsetHeight","offsetLeft","offsetTop","window","innerWidth","innerHeight","setAttribute","addEventListener","pointermove","pointerdown","pointerup","keydown","keyup","removeEventListener","connect"],"mappings":"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","sourcesContent":["var __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nimport { EventDispatcher, Quaternion, Vector3 } from \"three\";\nfunction contextmenu(event) {\n  event.preventDefault();\n}\nclass FlyControls extends EventDispatcher {\n  constructor(object, domElement) {\n    super();\n    __publicField(this, \"object\");\n    __publicField(this, \"domElement\", null);\n    __publicField(this, \"movementSpeed\", 1);\n    __publicField(this, \"rollSpeed\", 5e-3);\n    __publicField(this, \"dragToLook\", false);\n    __publicField(this, \"autoForward\", false);\n    __publicField(this, \"changeEvent\", { type: \"change\" });\n    __publicField(this, \"EPS\", 1e-6);\n    __publicField(this, \"tmpQuaternion\", new Quaternion());\n    __publicField(this, \"mouseStatus\", 0);\n    __publicField(this, \"movementSpeedMultiplier\", 1);\n    __publicField(this, \"moveState\", {\n      up: 0,\n      down: 0,\n      left: 0,\n      right: 0,\n      forward: 0,\n      back: 0,\n      pitchUp: 0,\n      pitchDown: 0,\n      yawLeft: 0,\n      yawRight: 0,\n      rollLeft: 0,\n      rollRight: 0\n    });\n    __publicField(this, \"moveVector\", new Vector3(0, 0, 0));\n    __publicField(this, \"rotationVector\", new Vector3(0, 0, 0));\n    __publicField(this, \"keydown\", (event) => {\n      if (event.altKey) {\n        return;\n      }\n      switch (event.code) {\n        case \"ShiftLeft\":\n        case \"ShiftRight\":\n          this.movementSpeedMultiplier = 0.1;\n          break;\n        case \"KeyW\":\n          this.moveState.forward = 1;\n          break;\n        case \"KeyS\":\n          this.moveState.back = 1;\n          break;\n        case \"KeyA\":\n          this.moveState.left = 1;\n          break;\n        case \"KeyD\":\n          this.moveState.right = 1;\n          break;\n        case \"KeyR\":\n          this.moveState.up = 1;\n          break;\n        case \"KeyF\":\n          this.moveState.down = 1;\n          break;\n        case \"ArrowUp\":\n          this.moveState.pitchUp = 1;\n          break;\n        case \"ArrowDown\":\n          this.moveState.pitchDown = 1;\n          break;\n        case \"ArrowLeft\":\n          this.moveState.yawLeft = 1;\n          break;\n        case \"ArrowRight\":\n          this.moveState.yawRight = 1;\n          break;\n        case \"KeyQ\":\n          this.moveState.rollLeft = 1;\n          break;\n        case \"KeyE\":\n          this.moveState.rollRight = 1;\n          break;\n      }\n      this.updateMovementVector();\n      this.updateRotationVector();\n    });\n    __publicField(this, \"keyup\", (event) => {\n      switch (event.code) {\n        case \"ShiftLeft\":\n        case \"ShiftRight\":\n          this.movementSpeedMultiplier = 1;\n          break;\n        case \"KeyW\":\n          this.moveState.forward = 0;\n          break;\n        case \"KeyS\":\n          this.moveState.back = 0;\n          break;\n        case \"KeyA\":\n          this.moveState.left = 0;\n          break;\n        case \"KeyD\":\n          this.moveState.right = 0;\n          break;\n        case \"KeyR\":\n          this.moveState.up = 0;\n          break;\n        case \"KeyF\":\n          this.moveState.down = 0;\n          break;\n        case \"ArrowUp\":\n          this.moveState.pitchUp = 0;\n          break;\n        case \"ArrowDown\":\n          this.moveState.pitchDown = 0;\n          break;\n        case \"ArrowLeft\":\n          this.moveState.yawLeft = 0;\n          break;\n        case \"ArrowRight\":\n          this.moveState.yawRight = 0;\n          break;\n        case \"KeyQ\":\n          this.moveState.rollLeft = 0;\n          break;\n        case \"KeyE\":\n          this.moveState.rollRight = 0;\n          break;\n      }\n      this.updateMovementVector();\n      this.updateRotationVector();\n    });\n    __publicField(this, \"pointerdown\", (event) => {\n      if (this.dragToLook) {\n        this.mouseStatus++;\n      } else {\n        switch (event.button) {\n          case 0:\n            this.moveState.forward = 1;\n            break;\n          case 2:\n            this.moveState.back = 1;\n            break;\n        }\n        this.updateMovementVector();\n      }\n    });\n    __publicField(this, \"pointermove\", (event) => {\n      if (!this.dragToLook || this.mouseStatus > 0) {\n        const container = this.getContainerDimensions();\n        const halfWidth = container.size[0] / 2;\n        const halfHeight = container.size[1] / 2;\n        this.moveState.yawLeft = -(event.pageX - container.offset[0] - halfWidth) / halfWidth;\n        this.moveState.pitchDown = (event.pageY - container.offset[1] - halfHeight) / halfHeight;\n        this.updateRotationVector();\n      }\n    });\n    __publicField(this, \"pointerup\", (event) => {\n      if (this.dragToLook) {\n        this.mouseStatus--;\n        this.moveState.yawLeft = this.moveState.pitchDown = 0;\n      } else {\n        switch (event.button) {\n          case 0:\n            this.moveState.forward = 0;\n            break;\n          case 2:\n            this.moveState.back = 0;\n            break;\n        }\n        this.updateMovementVector();\n      }\n      this.updateRotationVector();\n    });\n    __publicField(this, \"lastQuaternion\", new Quaternion());\n    __publicField(this, \"lastPosition\", new Vector3());\n    __publicField(this, \"update\", (delta) => {\n      const moveMult = delta * this.movementSpeed;\n      const rotMult = delta * this.rollSpeed;\n      this.object.translateX(this.moveVector.x * moveMult);\n      this.object.translateY(this.moveVector.y * moveMult);\n      this.object.translateZ(this.moveVector.z * moveMult);\n      this.tmpQuaternion.set(this.rotationVector.x * rotMult, this.rotationVector.y * rotMult, this.rotationVector.z * rotMult, 1).normalize();\n      this.object.quaternion.multiply(this.tmpQuaternion);\n      if (this.lastPosition.distanceToSquared(this.object.position) > this.EPS || 8 * (1 - this.lastQuaternion.dot(this.object.quaternion)) > this.EPS) {\n        this.dispatchEvent(this.changeEvent);\n        this.lastQuaternion.copy(this.object.quaternion);\n        this.lastPosition.copy(this.object.position);\n      }\n    });\n    __publicField(this, \"updateMovementVector\", () => {\n      const forward = this.moveState.forward || this.autoForward && !this.moveState.back ? 1 : 0;\n      this.moveVector.x = -this.moveState.left + this.moveState.right;\n      this.moveVector.y = -this.moveState.down + this.moveState.up;\n      this.moveVector.z = -forward + this.moveState.back;\n    });\n    __publicField(this, \"updateRotationVector\", () => {\n      this.rotationVector.x = -this.moveState.pitchDown + this.moveState.pitchUp;\n      this.rotationVector.y = -this.moveState.yawRight + this.moveState.yawLeft;\n      this.rotationVector.z = -this.moveState.rollRight + this.moveState.rollLeft;\n    });\n    __publicField(this, \"getContainerDimensions\", () => {\n      if (this.domElement != document && !(this.domElement instanceof Document)) {\n        return {\n          size: [this.domElement.offsetWidth, this.domElement.offsetHeight],\n          offset: [this.domElement.offsetLeft, this.domElement.offsetTop]\n        };\n      } else {\n        return {\n          size: [window.innerWidth, window.innerHeight],\n          offset: [0, 0]\n        };\n      }\n    });\n    // https://github.com/mrdoob/three.js/issues/20575\n    __publicField(this, \"connect\", (domElement) => {\n      this.domElement = domElement;\n      if (domElement && !(domElement instanceof Document)) {\n        domElement.setAttribute(\"tabindex\", -1);\n      }\n      this.domElement.addEventListener(\"contextmenu\", contextmenu);\n      this.domElement.addEventListener(\"pointermove\", this.pointermove);\n      this.domElement.addEventListener(\"pointerdown\", this.pointerdown);\n      this.domElement.addEventListener(\"pointerup\", this.pointerup);\n      window.addEventListener(\"keydown\", this.keydown);\n      window.addEventListener(\"keyup\", this.keyup);\n    });\n    __publicField(this, \"dispose\", () => {\n      this.domElement.removeEventListener(\"contextmenu\", contextmenu);\n      this.domElement.removeEventListener(\"pointermove\", this.pointermove);\n      this.domElement.removeEventListener(\"pointerdown\", this.pointerdown);\n      this.domElement.removeEventListener(\"pointerup\", this.pointerup);\n      window.removeEventListener(\"keydown\", this.keydown);\n      window.removeEventListener(\"keyup\", this.keyup);\n    });\n    this.object = object;\n    if (domElement !== void 0)\n      this.connect(domElement);\n    this.updateMovementVector();\n    this.updateRotationVector();\n  }\n}\nexport {\n  FlyControls\n};\n"]},"metadata":{},"sourceType":"module"}