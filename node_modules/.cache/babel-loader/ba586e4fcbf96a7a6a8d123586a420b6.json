{"ast":null,"code":"import _classCallCheck from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport { Matrix3, OrthographicCamera, Scene, StereoCamera, LinearFilter, NearestFilter, RGBAFormat, WebGLRenderTarget, ShaderMaterial, Mesh, PlaneGeometry } from \"three\";\n\nvar AnaglyphEffect = function AnaglyphEffect(renderer) {\n  var width = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 512;\n  var height = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 512;\n\n  _classCallCheck(this, AnaglyphEffect);\n\n  this.colorMatrixLeft = new Matrix3().fromArray([0.4561, -0.0400822, -0.0152161, 0.500484, -0.0378246, -0.0205971, 0.176381, -0.0157589, -546856e-8]);\n  this.colorMatrixRight = new Matrix3().fromArray([-0.0434706, 0.378476, -0.0721527, -0.0879388, 0.73364, -0.112961, -155529e-8, -0.0184503, 1.2264]);\n\n  var _camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n\n  var _scene = new Scene();\n\n  var _stereo = new StereoCamera();\n\n  var _params = {\n    minFilter: LinearFilter,\n    magFilter: NearestFilter,\n    format: RGBAFormat\n  };\n\n  var _renderTargetL = new WebGLRenderTarget(width, height, _params);\n\n  var _renderTargetR = new WebGLRenderTarget(width, height, _params);\n\n  var _material = new ShaderMaterial({\n    uniforms: {\n      mapLeft: {\n        value: _renderTargetL.texture\n      },\n      mapRight: {\n        value: _renderTargetR.texture\n      },\n      colorMatrixLeft: {\n        value: this.colorMatrixLeft\n      },\n      colorMatrixRight: {\n        value: this.colorMatrixRight\n      }\n    },\n    vertexShader: [\"varying vec2 vUv;\", \"void main() {\", \"\tvUv = vec2( uv.x, uv.y );\", \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\", \"}\"].join(\"\\n\"),\n    fragmentShader: [\"uniform sampler2D mapLeft;\", \"uniform sampler2D mapRight;\", \"varying vec2 vUv;\", \"uniform mat3 colorMatrixLeft;\", \"uniform mat3 colorMatrixRight;\", \"void main() {\", \"\tvec2 uv = vUv;\", \"\tvec4 colorL = texture2D( mapLeft, uv );\", \"\tvec4 colorR = texture2D( mapRight, uv );\", \"\tvec3 color = clamp(\", \"\t\t\tcolorMatrixLeft * colorL.rgb +\", \"\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );\", \"\tgl_FragColor = vec4(\", \"\t\t\tcolor.r, color.g, color.b,\", \"\t\t\tmax( colorL.a, colorR.a ) );\", \"\t#include <tonemapping_fragment>\", \"\t#include <encodings_fragment>\", \"}\"].join(\"\\n\")\n  });\n\n  var _mesh = new Mesh(new PlaneGeometry(2, 2), _material);\n\n  _scene.add(_mesh);\n\n  this.setSize = function (width2, height2) {\n    renderer.setSize(width2, height2);\n    var pixelRatio = renderer.getPixelRatio();\n\n    _renderTargetL.setSize(width2 * pixelRatio, height2 * pixelRatio);\n\n    _renderTargetR.setSize(width2 * pixelRatio, height2 * pixelRatio);\n  };\n\n  this.render = function (scene, camera) {\n    var currentRenderTarget = renderer.getRenderTarget();\n    if (scene.matrixWorldAutoUpdate === true) scene.updateMatrixWorld();\n    if (camera.parent === null && camera.matrixWorldAutoUpdate === true) camera.updateMatrixWorld();\n\n    _stereo.update(camera);\n\n    renderer.setRenderTarget(_renderTargetL);\n    renderer.clear();\n    renderer.render(scene, _stereo.cameraL);\n    renderer.setRenderTarget(_renderTargetR);\n    renderer.clear();\n    renderer.render(scene, _stereo.cameraR);\n    renderer.setRenderTarget(null);\n    renderer.render(_scene, _camera);\n    renderer.setRenderTarget(currentRenderTarget);\n  };\n\n  this.dispose = function () {\n    _renderTargetL.dispose();\n\n    _renderTargetR.dispose();\n\n    _mesh.geometry.dispose();\n\n    _mesh.material.dispose();\n  };\n};\n\nexport { AnaglyphEffect };","map":{"version":3,"sources":["/Users/theodaguier/Repositories/E-Do-Studio/node_modules/three-stdlib/effects/AnaglyphEffect.js"],"names":["Matrix3","OrthographicCamera","Scene","StereoCamera","LinearFilter","NearestFilter","RGBAFormat","WebGLRenderTarget","ShaderMaterial","Mesh","PlaneGeometry","AnaglyphEffect","renderer","width","height","colorMatrixLeft","fromArray","colorMatrixRight","_camera","_scene","_stereo","_params","minFilter","magFilter","format","_renderTargetL","_renderTargetR","_material","uniforms","mapLeft","value","texture","mapRight","vertexShader","join","fragmentShader","_mesh","add","setSize","width2","height2","pixelRatio","getPixelRatio","render","scene","camera","currentRenderTarget","getRenderTarget","matrixWorldAutoUpdate","updateMatrixWorld","parent","update","setRenderTarget","clear","cameraL","cameraR","dispose","geometry","material"],"mappings":"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","sourcesContent":["import { Matrix3, OrthographicCamera, Scene, StereoCamera, LinearFilter, NearestFilter, RGBAFormat, WebGLRenderTarget, ShaderMaterial, Mesh, PlaneGeometry } from \"three\";\nclass AnaglyphEffect {\n  constructor(renderer, width = 512, height = 512) {\n    this.colorMatrixLeft = new Matrix3().fromArray([\n      0.4561,\n      -0.0400822,\n      -0.0152161,\n      0.500484,\n      -0.0378246,\n      -0.0205971,\n      0.176381,\n      -0.0157589,\n      -546856e-8\n    ]);\n    this.colorMatrixRight = new Matrix3().fromArray([\n      -0.0434706,\n      0.378476,\n      -0.0721527,\n      -0.0879388,\n      0.73364,\n      -0.112961,\n      -155529e-8,\n      -0.0184503,\n      1.2264\n    ]);\n    const _camera = new OrthographicCamera(-1, 1, 1, -1, 0, 1);\n    const _scene = new Scene();\n    const _stereo = new StereoCamera();\n    const _params = { minFilter: LinearFilter, magFilter: NearestFilter, format: RGBAFormat };\n    const _renderTargetL = new WebGLRenderTarget(width, height, _params);\n    const _renderTargetR = new WebGLRenderTarget(width, height, _params);\n    const _material = new ShaderMaterial({\n      uniforms: {\n        mapLeft: { value: _renderTargetL.texture },\n        mapRight: { value: _renderTargetR.texture },\n        colorMatrixLeft: { value: this.colorMatrixLeft },\n        colorMatrixRight: { value: this.colorMatrixRight }\n      },\n      vertexShader: [\n        \"varying vec2 vUv;\",\n        \"void main() {\",\n        \"\tvUv = vec2( uv.x, uv.y );\",\n        \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n        \"}\"\n      ].join(\"\\n\"),\n      fragmentShader: [\n        \"uniform sampler2D mapLeft;\",\n        \"uniform sampler2D mapRight;\",\n        \"varying vec2 vUv;\",\n        \"uniform mat3 colorMatrixLeft;\",\n        \"uniform mat3 colorMatrixRight;\",\n        \"void main() {\",\n        \"\tvec2 uv = vUv;\",\n        \"\tvec4 colorL = texture2D( mapLeft, uv );\",\n        \"\tvec4 colorR = texture2D( mapRight, uv );\",\n        \"\tvec3 color = clamp(\",\n        \"\t\t\tcolorMatrixLeft * colorL.rgb +\",\n        \"\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );\",\n        \"\tgl_FragColor = vec4(\",\n        \"\t\t\tcolor.r, color.g, color.b,\",\n        \"\t\t\tmax( colorL.a, colorR.a ) );\",\n        \"\t#include <tonemapping_fragment>\",\n        \"\t#include <encodings_fragment>\",\n        \"}\"\n      ].join(\"\\n\")\n    });\n    const _mesh = new Mesh(new PlaneGeometry(2, 2), _material);\n    _scene.add(_mesh);\n    this.setSize = function(width2, height2) {\n      renderer.setSize(width2, height2);\n      const pixelRatio = renderer.getPixelRatio();\n      _renderTargetL.setSize(width2 * pixelRatio, height2 * pixelRatio);\n      _renderTargetR.setSize(width2 * pixelRatio, height2 * pixelRatio);\n    };\n    this.render = function(scene, camera) {\n      const currentRenderTarget = renderer.getRenderTarget();\n      if (scene.matrixWorldAutoUpdate === true)\n        scene.updateMatrixWorld();\n      if (camera.parent === null && camera.matrixWorldAutoUpdate === true)\n        camera.updateMatrixWorld();\n      _stereo.update(camera);\n      renderer.setRenderTarget(_renderTargetL);\n      renderer.clear();\n      renderer.render(scene, _stereo.cameraL);\n      renderer.setRenderTarget(_renderTargetR);\n      renderer.clear();\n      renderer.render(scene, _stereo.cameraR);\n      renderer.setRenderTarget(null);\n      renderer.render(_scene, _camera);\n      renderer.setRenderTarget(currentRenderTarget);\n    };\n    this.dispose = function() {\n      _renderTargetL.dispose();\n      _renderTargetR.dispose();\n      _mesh.geometry.dispose();\n      _mesh.material.dispose();\n    };\n  }\n}\nexport {\n  AnaglyphEffect\n};\n"]},"metadata":{},"sourceType":"module"}