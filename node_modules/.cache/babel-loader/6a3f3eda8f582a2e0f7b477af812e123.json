{"ast":null,"code":"import _classCallCheck from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/theodaguier/Repositories/E-Do-Studio/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { PerspectiveCamera, ShaderMaterial, Scene, OrthographicCamera, WebGLRenderTarget, UniformsUtils, Mesh, PlaneGeometry } from \"three\";\nimport { BokehDepthShader, BokehShader2 } from \"../shaders/BokehShader2.js\";\n\nvar CinematicCamera = /*#__PURE__*/function (_PerspectiveCamera) {\n  _inherits(CinematicCamera, _PerspectiveCamera);\n\n  var _super = _createSuper(CinematicCamera);\n\n  function CinematicCamera(fov, aspect, near, far) {\n    var _this;\n\n    _classCallCheck(this, CinematicCamera);\n\n    _this = _super.call(this, fov, aspect, near, far);\n    _this.type = \"CinematicCamera\";\n    _this.postprocessing = {\n      enabled: true\n    };\n    _this.shaderSettings = {\n      rings: 3,\n      samples: 4\n    };\n    var depthShader = BokehDepthShader;\n    _this.materialDepth = new ShaderMaterial({\n      uniforms: depthShader.uniforms,\n      vertexShader: depthShader.vertexShader,\n      fragmentShader: depthShader.fragmentShader\n    });\n    _this.materialDepth.uniforms[\"mNear\"].value = near;\n    _this.materialDepth.uniforms[\"mFar\"].value = far;\n\n    _this.setLens();\n\n    _this.initPostProcessing();\n\n    return _this;\n  } // providing fnumber and coc(Circle of Confusion) as extra arguments\n\n\n  _createClass(CinematicCamera, [{\n    key: \"setLens\",\n    value: function setLens(focalLength, filmGauge, fNumber, coc) {\n      if (focalLength === void 0) focalLength = 35;\n      if (filmGauge !== void 0) this.filmGauge = filmGauge;\n      this.setFocalLength(focalLength);\n      if (fNumber === void 0) fNumber = 8;\n      if (coc === void 0) coc = 0.019;\n      this.fNumber = fNumber;\n      this.coc = coc;\n      this.aperture = focalLength / this.fNumber;\n      this.hyperFocal = focalLength * focalLength / (this.aperture * this.coc);\n    }\n  }, {\n    key: \"linearize\",\n    value: function linearize(depth) {\n      var zfar = this.far;\n      var znear = this.near;\n      return -zfar * znear / (depth * (zfar - znear) - zfar);\n    }\n  }, {\n    key: \"smoothstep\",\n    value: function smoothstep(near, far, depth) {\n      var x = this.saturate((depth - near) / (far - near));\n      return x * x * (3 - 2 * x);\n    }\n  }, {\n    key: \"saturate\",\n    value: function saturate(x) {\n      return Math.max(0, Math.min(1, x));\n    } // function for focusing at a distance from the camera\n\n  }, {\n    key: \"focusAt\",\n    value: function focusAt(focusDistance) {\n      if (focusDistance === void 0) focusDistance = 20;\n      var focalLength = this.getFocalLength();\n      this.focus = focusDistance;\n      this.nearPoint = this.hyperFocal * this.focus / (this.hyperFocal + (this.focus - focalLength));\n      this.farPoint = this.hyperFocal * this.focus / (this.hyperFocal - (this.focus - focalLength));\n      this.depthOfField = this.farPoint - this.nearPoint;\n      if (this.depthOfField < 0) this.depthOfField = 0;\n      this.sdistance = this.smoothstep(this.near, this.far, this.focus);\n      this.ldistance = this.linearize(1 - this.sdistance);\n      this.postprocessing.bokeh_uniforms[\"focalDepth\"].value = this.ldistance;\n    }\n  }, {\n    key: \"initPostProcessing\",\n    value: function initPostProcessing() {\n      if (this.postprocessing.enabled) {\n        this.postprocessing.scene = new Scene();\n        this.postprocessing.camera = new OrthographicCamera(window.innerWidth / -2, window.innerWidth / 2, window.innerHeight / 2, window.innerHeight / -2, -1e4, 1e4);\n        this.postprocessing.scene.add(this.postprocessing.camera);\n        this.postprocessing.rtTextureDepth = new WebGLRenderTarget(window.innerWidth, window.innerHeight);\n        this.postprocessing.rtTextureColor = new WebGLRenderTarget(window.innerWidth, window.innerHeight);\n        var bokeh_shader = BokehShader2;\n        this.postprocessing.bokeh_uniforms = UniformsUtils.clone(bokeh_shader.uniforms);\n        this.postprocessing.bokeh_uniforms[\"tColor\"].value = this.postprocessing.rtTextureColor.texture;\n        this.postprocessing.bokeh_uniforms[\"tDepth\"].value = this.postprocessing.rtTextureDepth.texture;\n        this.postprocessing.bokeh_uniforms[\"manualdof\"].value = 0;\n        this.postprocessing.bokeh_uniforms[\"shaderFocus\"].value = 0;\n        this.postprocessing.bokeh_uniforms[\"fstop\"].value = 2.8;\n        this.postprocessing.bokeh_uniforms[\"showFocus\"].value = 1;\n        this.postprocessing.bokeh_uniforms[\"focalDepth\"].value = 0.1;\n        this.postprocessing.bokeh_uniforms[\"znear\"].value = this.near;\n        this.postprocessing.bokeh_uniforms[\"zfar\"].value = this.near;\n        this.postprocessing.bokeh_uniforms[\"textureWidth\"].value = window.innerWidth;\n        this.postprocessing.bokeh_uniforms[\"textureHeight\"].value = window.innerHeight;\n        this.postprocessing.materialBokeh = new ShaderMaterial({\n          uniforms: this.postprocessing.bokeh_uniforms,\n          vertexShader: bokeh_shader.vertexShader,\n          fragmentShader: bokeh_shader.fragmentShader,\n          defines: {\n            RINGS: this.shaderSettings.rings,\n            SAMPLES: this.shaderSettings.samples,\n            DEPTH_PACKING: 1\n          }\n        });\n        this.postprocessing.quad = new Mesh(new PlaneGeometry(window.innerWidth, window.innerHeight), this.postprocessing.materialBokeh);\n        this.postprocessing.quad.position.z = -500;\n        this.postprocessing.scene.add(this.postprocessing.quad);\n      }\n    }\n  }, {\n    key: \"renderCinematic\",\n    value: function renderCinematic(scene, renderer) {\n      if (this.postprocessing.enabled) {\n        var currentRenderTarget = renderer.getRenderTarget();\n        renderer.clear();\n        scene.overrideMaterial = null;\n        renderer.setRenderTarget(this.postprocessing.rtTextureColor);\n        renderer.clear();\n        renderer.render(scene, this);\n        scene.overrideMaterial = this.materialDepth;\n        renderer.setRenderTarget(this.postprocessing.rtTextureDepth);\n        renderer.clear();\n        renderer.render(scene, this);\n        renderer.setRenderTarget(null);\n        renderer.render(this.postprocessing.scene, this.postprocessing.camera);\n        renderer.setRenderTarget(currentRenderTarget);\n      }\n    }\n  }]);\n\n  return CinematicCamera;\n}(PerspectiveCamera);\n\nexport { CinematicCamera };","map":{"version":3,"sources":["/Users/theodaguier/Repositories/E-Do-Studio/node_modules/three-stdlib/cameras/CinematicCamera.js"],"names":["PerspectiveCamera","ShaderMaterial","Scene","OrthographicCamera","WebGLRenderTarget","UniformsUtils","Mesh","PlaneGeometry","BokehDepthShader","BokehShader2","CinematicCamera","fov","aspect","near","far","type","postprocessing","enabled","shaderSettings","rings","samples","depthShader","materialDepth","uniforms","vertexShader","fragmentShader","value","setLens","initPostProcessing","focalLength","filmGauge","fNumber","coc","setFocalLength","aperture","hyperFocal","depth","zfar","znear","x","saturate","Math","max","min","focusDistance","getFocalLength","focus","nearPoint","farPoint","depthOfField","sdistance","smoothstep","ldistance","linearize","bokeh_uniforms","scene","camera","window","innerWidth","innerHeight","add","rtTextureDepth","rtTextureColor","bokeh_shader","clone","texture","materialBokeh","defines","RINGS","SAMPLES","DEPTH_PACKING","quad","position","z","renderer","currentRenderTarget","getRenderTarget","clear","overrideMaterial","setRenderTarget","render"],"mappings":"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","sourcesContent":["import { PerspectiveCamera, ShaderMaterial, Scene, OrthographicCamera, WebGLRenderTarget, UniformsUtils, Mesh, PlaneGeometry } from \"three\";\nimport { BokehDepthShader, BokehShader2 } from \"../shaders/BokehShader2.js\";\nclass CinematicCamera extends PerspectiveCamera {\n  constructor(fov, aspect, near, far) {\n    super(fov, aspect, near, far);\n    this.type = \"CinematicCamera\";\n    this.postprocessing = { enabled: true };\n    this.shaderSettings = {\n      rings: 3,\n      samples: 4\n    };\n    const depthShader = BokehDepthShader;\n    this.materialDepth = new ShaderMaterial({\n      uniforms: depthShader.uniforms,\n      vertexShader: depthShader.vertexShader,\n      fragmentShader: depthShader.fragmentShader\n    });\n    this.materialDepth.uniforms[\"mNear\"].value = near;\n    this.materialDepth.uniforms[\"mFar\"].value = far;\n    this.setLens();\n    this.initPostProcessing();\n  }\n  // providing fnumber and coc(Circle of Confusion) as extra arguments\n  setLens(focalLength, filmGauge, fNumber, coc) {\n    if (focalLength === void 0)\n      focalLength = 35;\n    if (filmGauge !== void 0)\n      this.filmGauge = filmGauge;\n    this.setFocalLength(focalLength);\n    if (fNumber === void 0)\n      fNumber = 8;\n    if (coc === void 0)\n      coc = 0.019;\n    this.fNumber = fNumber;\n    this.coc = coc;\n    this.aperture = focalLength / this.fNumber;\n    this.hyperFocal = focalLength * focalLength / (this.aperture * this.coc);\n  }\n  linearize(depth) {\n    const zfar = this.far;\n    const znear = this.near;\n    return -zfar * znear / (depth * (zfar - znear) - zfar);\n  }\n  smoothstep(near, far, depth) {\n    const x = this.saturate((depth - near) / (far - near));\n    return x * x * (3 - 2 * x);\n  }\n  saturate(x) {\n    return Math.max(0, Math.min(1, x));\n  }\n  // function for focusing at a distance from the camera\n  focusAt(focusDistance) {\n    if (focusDistance === void 0)\n      focusDistance = 20;\n    const focalLength = this.getFocalLength();\n    this.focus = focusDistance;\n    this.nearPoint = this.hyperFocal * this.focus / (this.hyperFocal + (this.focus - focalLength));\n    this.farPoint = this.hyperFocal * this.focus / (this.hyperFocal - (this.focus - focalLength));\n    this.depthOfField = this.farPoint - this.nearPoint;\n    if (this.depthOfField < 0)\n      this.depthOfField = 0;\n    this.sdistance = this.smoothstep(this.near, this.far, this.focus);\n    this.ldistance = this.linearize(1 - this.sdistance);\n    this.postprocessing.bokeh_uniforms[\"focalDepth\"].value = this.ldistance;\n  }\n  initPostProcessing() {\n    if (this.postprocessing.enabled) {\n      this.postprocessing.scene = new Scene();\n      this.postprocessing.camera = new OrthographicCamera(\n        window.innerWidth / -2,\n        window.innerWidth / 2,\n        window.innerHeight / 2,\n        window.innerHeight / -2,\n        -1e4,\n        1e4\n      );\n      this.postprocessing.scene.add(this.postprocessing.camera);\n      this.postprocessing.rtTextureDepth = new WebGLRenderTarget(window.innerWidth, window.innerHeight);\n      this.postprocessing.rtTextureColor = new WebGLRenderTarget(window.innerWidth, window.innerHeight);\n      const bokeh_shader = BokehShader2;\n      this.postprocessing.bokeh_uniforms = UniformsUtils.clone(bokeh_shader.uniforms);\n      this.postprocessing.bokeh_uniforms[\"tColor\"].value = this.postprocessing.rtTextureColor.texture;\n      this.postprocessing.bokeh_uniforms[\"tDepth\"].value = this.postprocessing.rtTextureDepth.texture;\n      this.postprocessing.bokeh_uniforms[\"manualdof\"].value = 0;\n      this.postprocessing.bokeh_uniforms[\"shaderFocus\"].value = 0;\n      this.postprocessing.bokeh_uniforms[\"fstop\"].value = 2.8;\n      this.postprocessing.bokeh_uniforms[\"showFocus\"].value = 1;\n      this.postprocessing.bokeh_uniforms[\"focalDepth\"].value = 0.1;\n      this.postprocessing.bokeh_uniforms[\"znear\"].value = this.near;\n      this.postprocessing.bokeh_uniforms[\"zfar\"].value = this.near;\n      this.postprocessing.bokeh_uniforms[\"textureWidth\"].value = window.innerWidth;\n      this.postprocessing.bokeh_uniforms[\"textureHeight\"].value = window.innerHeight;\n      this.postprocessing.materialBokeh = new ShaderMaterial({\n        uniforms: this.postprocessing.bokeh_uniforms,\n        vertexShader: bokeh_shader.vertexShader,\n        fragmentShader: bokeh_shader.fragmentShader,\n        defines: {\n          RINGS: this.shaderSettings.rings,\n          SAMPLES: this.shaderSettings.samples,\n          DEPTH_PACKING: 1\n        }\n      });\n      this.postprocessing.quad = new Mesh(\n        new PlaneGeometry(window.innerWidth, window.innerHeight),\n        this.postprocessing.materialBokeh\n      );\n      this.postprocessing.quad.position.z = -500;\n      this.postprocessing.scene.add(this.postprocessing.quad);\n    }\n  }\n  renderCinematic(scene, renderer) {\n    if (this.postprocessing.enabled) {\n      const currentRenderTarget = renderer.getRenderTarget();\n      renderer.clear();\n      scene.overrideMaterial = null;\n      renderer.setRenderTarget(this.postprocessing.rtTextureColor);\n      renderer.clear();\n      renderer.render(scene, this);\n      scene.overrideMaterial = this.materialDepth;\n      renderer.setRenderTarget(this.postprocessing.rtTextureDepth);\n      renderer.clear();\n      renderer.render(scene, this);\n      renderer.setRenderTarget(null);\n      renderer.render(this.postprocessing.scene, this.postprocessing.camera);\n      renderer.setRenderTarget(currentRenderTarget);\n    }\n  }\n}\nexport {\n  CinematicCamera\n};\n"]},"metadata":{},"sourceType":"module"}